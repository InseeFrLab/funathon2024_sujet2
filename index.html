<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>âœˆï¸ - Un tableau de bord du trafic aÃ©rien avec  ou </title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="site_libs/leaflet-1.3.1/leaflet.js"></script>
<link href="site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="site_libs/proj4-2.6.2/proj4.min.js"></script>
<script src="site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="site_libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<script src="site_libs/core-js-2.5.3/shim.min.js"></script>
<script src="site_libs/react-18.2.0/react.min.js"></script>
<script src="site_libs/react-18.2.0/react-dom.min.js"></script>
<script src="site_libs/reactwidget-1.0.0/react-tools.js"></script>
<link href="site_libs/reactable-0.4.4/reactable.css" rel="stylesheet">
<script src="site_libs/reactable-binding-0.4.4/reactable.js"></script>
<link href="site_libs/leaflet-awesomemarkers-2.0.3/leaflet.awesome-markers.css" rel="stylesheet">
<script src="site_libs/leaflet-awesomemarkers-2.0.3/leaflet.awesome-markers.min.js"></script>
<link href="site_libs/fontawesome-4.7.0/font-awesome.min.css" rel="stylesheet">


</head>

<body class="nav-fixed">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">âœˆï¸</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./trame.qmd" rel="" target="">
 <span class="menu-text">Consigne de lâ€™exercice</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://rplane-dashboard.kub.sspcloud.fr/" rel="" target="">
 <span class="menu-text">Tableau de bord (version <i class="fa-brands fa-r-project" aria-label="r-project"></i>)</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#objectif" id="toc-objectif" class="nav-link" data-scroll-target="#objectif"><span class="header-section-number">1.1</span> Objectif</a></li>
  <li><a href="#pourquoi-faire-une-application-interactive" id="toc-pourquoi-faire-une-application-interactive" class="nav-link" data-scroll-target="#pourquoi-faire-une-application-interactive"><span class="header-section-number">1.2</span> Pourquoi faire une application interactive ?</a></li>
  </ul></li>
  <li><a href="#exploration-des-donnÃ©es-de-trafic-aÃ©rien" id="toc-exploration-des-donnÃ©es-de-trafic-aÃ©rien" class="nav-link" data-scroll-target="#exploration-des-donnÃ©es-de-trafic-aÃ©rien"><span class="header-section-number">2</span> Exploration des donnÃ©es de trafic aÃ©rien</a>
  <ul class="collapse">
  <li><a href="#prÃ©liminaire-rÃ©cupÃ©rer-le-projet-squelette-avec-git-fa-brands-git-alt" id="toc-prÃ©liminaire-rÃ©cupÃ©rer-le-projet-squelette-avec-git-fa-brands-git-alt" class="nav-link" data-scroll-target="#prÃ©liminaire-rÃ©cupÃ©rer-le-projet-squelette-avec-git-fa-brands-git-alt"><span class="header-section-number">2.1</span> PrÃ©liminaire: rÃ©cupÃ©rer le projet squelette avec <code>Git</code> <i class="fa-brands fa-git-alt" aria-label="git-alt"></i></a></li>
  <li><a href="#installer-les-packages-nÃ©cessaires-pour-ce-tutoriel" id="toc-installer-les-packages-nÃ©cessaires-pour-ce-tutoriel" class="nav-link" data-scroll-target="#installer-les-packages-nÃ©cessaires-pour-ce-tutoriel"><span class="header-section-number">2.2</span> Installer les <em>packages</em> nÃ©cessaires pour ce tutoriel</a>
  <ul class="collapse">
  <li><a href="#principe" id="toc-principe" class="nav-link" data-scroll-target="#principe"><span class="header-section-number">2.2.1</span> Principe</a></li>
  <li><a href="#crÃ©er-lenvironnement" id="toc-crÃ©er-lenvironnement" class="nav-link" data-scroll-target="#crÃ©er-lenvironnement"><span class="header-section-number">2.2.2</span> CrÃ©er lâ€™environnement</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#rÃ©cupÃ©rer-les-donnÃ©es" id="toc-rÃ©cupÃ©rer-les-donnÃ©es" class="nav-link" data-scroll-target="#rÃ©cupÃ©rer-les-donnÃ©es"><span class="header-section-number">3</span> RÃ©cupÃ©rer les donnÃ©es</a>
  <ul class="collapse">
  <li><a href="#importer-la-liste-des-sources-disponibles" id="toc-importer-la-liste-des-sources-disponibles" class="nav-link" data-scroll-target="#importer-la-liste-des-sources-disponibles"><span class="header-section-number">3.1</span> Importer la liste des sources disponibles</a></li>
  <li><a href="#importer-les-premiÃ¨res-bases" id="toc-importer-les-premiÃ¨res-bases" class="nav-link" data-scroll-target="#importer-les-premiÃ¨res-bases"><span class="header-section-number">3.2</span> Importer les premiÃ¨res bases</a></li>
  </ul></li>
  <li><a href="#exploration-des-donnÃ©es" id="toc-exploration-des-donnÃ©es" class="nav-link" data-scroll-target="#exploration-des-donnÃ©es"><span class="header-section-number">4</span> Exploration des donnÃ©es</a>
  <ul class="collapse">
  <li><a href="#le-trafic-par-aÃ©roport" id="toc-le-trafic-par-aÃ©roport" class="nav-link" data-scroll-target="#le-trafic-par-aÃ©roport"><span class="header-section-number">4.1</span> Le trafic par aÃ©roport</a></li>
  <li><a href="#tableau-html-pour-afficher-des-donnÃ©es" id="toc-tableau-html-pour-afficher-des-donnÃ©es" class="nav-link" data-scroll-target="#tableau-html-pour-afficher-des-donnÃ©es"><span class="header-section-number">4.2</span> Tableau HTML pour afficher des donnÃ©es</a></li>
  <li><a href="#carte-des-aÃ©roports" id="toc-carte-des-aÃ©roports" class="nav-link" data-scroll-target="#carte-des-aÃ©roports"><span class="header-section-number">4.3</span> Carte des aÃ©roports</a></li>
  </ul></li>
  <li><a href="#crÃ©ation-de-lapplication" id="toc-crÃ©ation-de-lapplication" class="nav-link" data-scroll-target="#crÃ©ation-de-lapplication"><span class="header-section-number">5</span> CrÃ©ation de lâ€™application</a></li>
  <li><a href="#partager-cette-application-une-ouverture-vers-la-mise-en-production" id="toc-partager-cette-application-une-ouverture-vers-la-mise-en-production" class="nav-link" data-scroll-target="#partager-cette-application-une-ouverture-vers-la-mise-en-production"><span class="header-section-number">6</span> Partager cette application: une ouverture vers la mise en production</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Un tableau de bord du trafic aÃ©rien avec <i class="fa-brands fa-r-project" aria-label="r-project"></i> ou <i class="fa-brands fa-python" aria-label="python"></i></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<a href="https://datalab.sspcloud.fr/launcher/ide/rstudio?version=1.15.25&amp;autoLaunch=true&amp;networking.user.enabled=true&amp;git.repository=Â«https%3A%2F%2Fgithub.com%2FInseeFrLab%2Ffunathon2024_sujet2.gitÂ»&amp;onyxia.friendlyName=Â«config-funathon2024Â»&amp;kubernetes.role=Â«adminÂ»" target="_blank" rel="noopener"><img src="https://img.shields.io/badge/SSP%20Cloud-Ouvrir_dans_RStudio-blue?logo=rstudio&amp;logoColor=blue" alt="Onyxia"></a>
<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<section id="objectif" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="objectif"><span class="header-section-number">1.1</span> Objectif</h2>
<p>Lâ€™objectif de ce tutoriel est dâ€™amener, pas Ã  pas, Ã  la conception voire Ã  la mise Ã  disposition dâ€™un tableau de bord (<em>dashboard</em>) du trafic aÃ©rien avec <i class="fa-brands fa-r-project" aria-label="r-project"></i>. Une dÃ©monstration de cette application est disponible Ã  lâ€™adresse <a href="https://rplane-dashboard.kub.sspcloud.fr/" class="uri">https://rplane-dashboard.kub.sspcloud.fr/</a>. Ce tutoriel est Ã©galement lâ€™occasion dâ€™apprendre quelques bonnes pratiques pour les projets <i class="fa-brands fa-r-project" aria-label="r-project"></i> et <i class="fa-brands fa-python" aria-label="python"></i>.</p>
<p>Afin de se concentrer sur la dÃ©marche, cette application interactive prÃ©sentera un nombre limitÃ© de fonctionnalitÃ©s. Lâ€™objectif est de construire progressivement celle-ci en suivant les Ã©tapes logiques du dÃ©roulement dâ€™un projet de dÃ©veloppement dâ€™application interactive: dÃ©couverte et exploration des donnÃ©es, crÃ©ation de statistiques descriptives et de visualisations simples sur un jeu de donnÃ©es, extension du nombre de visualisations accessibles par la crÃ©ation dâ€™une application. Ce tutoriel est Ã©galement lâ€™occasion de dÃ©couvrir quelques bonnes pratiques de programmation avec <i class="fa-brands fa-r-project" aria-label="r-project"></i> afin de rendre les projets plus fiables, Ã©volutifs et lisibles.</p>
<p>Les exercices de conception pas Ã  pas de lâ€™application sâ€™adressent aussi bien Ã  des dÃ©butants quâ€™Ã  des utilisateurs plus experts. La mise Ã  disposition, câ€™est-Ã -dire la mise en production de cette application, fait appel Ã  des concepts et outils plus avancÃ©s et est donc moins accessible Ã  des dÃ©butants.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Si vous dÃ©sirez aller plus loin sur certaines dimensions de ce projet, vous pouvez tout Ã  fait essayer de vous-mÃªmes dâ€™introduire de nouveaux ingrÃ©dients dans lâ€™application que vous dÃ©veloppez.</p>
</div>
</div>
</section>
<section id="pourquoi-faire-une-application-interactive" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="pourquoi-faire-une-application-interactive"><span class="header-section-number">1.2</span> Pourquoi faire une application interactive ?</h2>
<p>Cette question peut apparaÃ®tre naive. Pourtant, elle mÃ©rite dâ€™Ãªtre posÃ©e car elle permet de rÃ©flÃ©chir Ã  lâ€™objectif de lâ€™application et Ã  son public cible. Cette rÃ©flexion devrait Ãªtre menÃ©e systÃ©matiquement car elle guide les choix techniques ultÃ©rieurs et la rÃ©partition des tÃ¢ches entre les diffÃ©rents profils pouvant intervenir dans la vie du projet sâ€™il est mis en production (statisticien ou <em>data scientist</em>, Ã©quipes informatiquesâ€¦).</p>
<p>En gÃ©nÃ©ral, on fait de la visualisation de donnÃ©es car les sources de donnÃ©es exploitÃ©es prÃ©sentent tellement de dimensions pouvant intÃ©resser un utilisateur quâ€™il est plus pertinent de le laisser explorer les donnÃ©es que de dÃ©finir pour lui les statistiques Ã  mettre en avant. Lâ€™interactivitÃ© permise par les sites web est particuliÃ¨rement adaptÃ©e pour cela: le fait dâ€™afficher ou masquer des visualisations en fonction de choix de lâ€™utilisateur Ã©vite de noyer lâ€™information par rapport Ã  des supports figÃ©s.</p>
<p>Les <em>frameworks</em> <code>Shiny</code> (<i class="fa-brands fa-r-project" aria-label="r-project"></i>), <code>Streamlit</code> ou <code>Dash</code> (<i class="fa-brands fa-python" aria-label="python"></i>) permettent de rapidement mettre en oeuvre ce type de site web. Pour une phase de construction dâ€™un prototype, câ€™est un choix technique intÃ©ressant qui peut provoquer lâ€™effet <em>wahou</em> attendu pour lancer le projet Ã  plus grande Ã©chelle. En effet, ces solutions techniques permettent, avec les outils bien connus des praticiens de la donnÃ©e, <i class="fa-brands fa-r-project" aria-label="r-project"></i> ou <i class="fa-brands fa-python" aria-label="python"></i> principalement, de crÃ©er rapidement un site web fonctionnel, ergonomique et effectuant des opÃ©rations en fonction dâ€™actions de lâ€™utilisateur sur la page web. Tout ceci sans avoir Ã  maÃ®triser des notions complexes de dÃ©veloppement web.</p>
<p>NÃ©anmoins, passÃ©e cette phase dâ€™expÃ©rimentation, le partage de ces applications, au-delÃ  dâ€™un partage dâ€™Ã©cran pour des dÃ©monstrations, est moins Ã©vident. Câ€™est parce que la connaissance de ces notions complexes qui permettent le bon fonctionnement dâ€™un site web et dont la maÃ®trise nâ€™est pas nÃ©cessaire lorsquâ€™on se lance dans la construction du site deviennent utiles passÃ©e la phase dâ€™expÃ©rimentation. Celles-ci dÃ©passent nÃ©anmoins le champ de compÃ©tence des statisticiens ou <em>data scientists</em>.</p>
<p>Autrement dit, si le projet a lâ€™ambition dâ€™Ãªtre partagÃ© Ã  une audience large qui nâ€™a pas les compÃ©tences techniques pour faire tourner elle-mÃªme le code, il convient de prendre en compte le fait quâ€™il faudra dans lâ€™Ã©quipe projet des compÃ©tences de dÃ©veloppement web. Si le projet est expÃ©rimental, câ€™est moins un problÃ¨me: <code>Shiny</code>, <code>Dash</code> ou <code>Streamlit</code> permettront dâ€™avoir rapidement un prototype viable.</p>
<p>Il existe heureusement des solutions techniques plus simples Ã  mettre en oeuvre que <code>Shiny</code>, <code>Streamlit</code> ou <code>Dash</code>. Les sites web statiques font partie de cet Ã©ventail des possibles et reprÃ©sentent souvent une alternative pertinente aux applications interactives Ã  condition quâ€™ils soient bien pensÃ©s. Ils sont notamment pertinents pour les applications de visualisation de donnÃ©es oÃ¹ cette derniÃ¨re est dÃ©jÃ  prÃ©parÃ©e en amont. Avoir un serveur <code>R</code> ou <code>Python</code> se justifie en effet si des Ã©tapes complexes de structuration de donnÃ©es interviennent. NÃ©anmoins, si celles-ci ne sont pas nÃ©cessaires, un simple enrobage avec un constructeur de site comme <code>Quarto</code> peut suffire, Ã  condition que les productions graphiques ne soient pas trop complexes Ã  crÃ©er. Pour des sites faisant intervenir des interactions complexes entre actions dâ€™un utilisateur (bouton, menu dÃ©roulant, etc. ) et affichage, il faudra recourir Ã  du <code>Javascript</code> (technologie utilisÃ©e par les sites spÃ©cialisÃ©s dans la <em>dataviz</em>), ce qui fait, Ã  nouveau, appel Ã  des compÃ©tences qui dÃ©passent celles des <em>data scientists</em> ou statisticiens classiques.</p>
<p>En rÃ©sumÃ©, les Ã©lÃ©ments ci-dessus ont vocation Ã  servir de mise en garde. <code>Shiny</code>, <code>Dash</code> ou <code>Streamlit</code> sont dâ€™excellents outils techniques lorsquâ€™ils sont utilisÃ©s Ã  bon escient. NÃ©anmoins, leur simplicitÃ© dâ€™usage ne doit pas amener Ã  oublier de se poser des questions vitales comme celui du cycle de vie du projet, du public cible ou encore de la compÃ©tence des Ã©quipes amenÃ©es Ã  le maintenir sâ€™il perdure au-delÃ  dâ€™une phase dâ€™expÃ©rimentation.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Site statique vs application rÃ©active
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>La solution que nous allons proposer pour les sites statiques, <code>Quarto</code> associÃ© Ã  <code>Github Pages</code>, peut Ãªtre utilisÃ©e dans le cadre des parcours <em>â€œrapport reproductibleâ€</em> ou <em>â€œdashboard / application interactiveâ€</em>.</p>
<p>La distinction principale entre ces deux approches est quâ€™elles sâ€™appuient sur des serveurs diffÃ©rents. Un site statique repose sur un serveur web lÃ  oÃ¹ <code>Streamlit</code> sâ€™appuie sur serveur classique en <em>backend</em>. La diffÃ©rence principale entre ces deux types de serveurs rÃ©side principalement dans leur fonction et leur utilisation:</p>
<ul>
<li>Un <strong>serveur web</strong> est spÃ©cifiquement conÃ§u pour stocker, traiter et livrer des pages web aux clients. Cela inclut des fichiers HTML, CSS, JavaScript, images, etc. Les serveurs web Ã©coutent les requÃªtes HTTP/HTTPS provenant des navigateurs des utilisateurs et y rÃ©pondent en envoyant les donnÃ©es demandÃ©es.</li>
<li>Un <strong>serveur <em>backend</em></strong> classique est conÃ§u pour effectuer des opÃ©rations en rÃ©ponse Ã  un <em>front</em>, en lâ€™occurrence une page web. Dans le contexte dâ€™une application <code>Streamlit</code> (resp. <code>Shiny</code>), il sâ€™agit dâ€™un serveur avec lâ€™environnement <code>Python</code> (resp. <code>R</code>) <em>ad hoc</em> pour exÃ©cuter le code nÃ©cessaire Ã  rÃ©pondre Ã  toute action dâ€™un utilisateur de lâ€™application.</li>
</ul>
</div>
</div>
</div>
</section>
</section>
<section id="exploration-des-donnÃ©es-de-trafic-aÃ©rien" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Exploration des donnÃ©es de trafic aÃ©rien</h1>
<p>Pour pouvoir proposer un tableau de bord pertinent, le premier geste Ã  avoir est dâ€™explorer soi-mÃªme les donnÃ©es. Lâ€™objectif de cette partie est de guider le travail exploratoire. Le travail ultÃ©rieur sur lâ€™application visera Ã  consolider et gÃ©nÃ©raliser ces explorations de donnÃ©es.</p>
<section id="prÃ©liminaire-rÃ©cupÃ©rer-le-projet-squelette-avec-git-fa-brands-git-alt" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="prÃ©liminaire-rÃ©cupÃ©rer-le-projet-squelette-avec-git-fa-brands-git-alt"><span class="header-section-number">2.1</span> PrÃ©liminaire: rÃ©cupÃ©rer le projet squelette avec <code>Git</code> <i class="fa-brands fa-git-alt" aria-label="git-alt"></i></h2>
<p>Si vous disposez dâ€™un compte sur le <a href="https://www.sspcloud.fr/"><code>sspcloud</code></a>, la mÃ©thode recommandÃ©e pour se lancer dans ce tutoriel est de cliquer sur le bouton suivant</p>
<center>
<a href="https://datalab.sspcloud.fr/launcher/ide/rstudio?version=1.15.25&amp;autoLaunch=true&amp;networking.user.enabled=true&amp;git.repository=Â«https%3A%2F%2Fgithub.com%2FInseeFrLab%2Ffunathon2024_sujet2.gitÂ»&amp;onyxia.friendlyName=Â«config-funathon2024Â»&amp;kubernetes.role=Â«adminÂ»" target="_blank" rel="noopener"><img src="https://img.shields.io/badge/SSP%20Cloud-Ouvrir_dans_RStudio-blue?logo=rstudio&amp;logoColor=blue" alt="Onyxia"></a>
</center>
<br>
<p>Si vous avez utilisÃ© le lien de lancement rapide mis Ã  disposition sur la page <a href="https://inseefrlab.github.io/funathon2024/">inseefrlab.github.io/funathon2024/</a> ou ci-dessus â˜ï¸, vous pouvez sauter lâ€™Ã©tape de rÃ©cupÃ©ration du modÃ¨le de projet avec <code>Git</code> <i class="fa-brands fa-git-alt" aria-label="git-alt"></i>, cela a Ã©tÃ© fait automatiquement lors de la crÃ©ation de votre environnement <code>RStudio</code>. Cela ne vous dispense dâ€™ailleurs pas de faire du <code>Git</code> tout au long du tutoriel, câ€™est une bonne pratique, mÃªme sur des projets ponctuels ou vous Ãªtes seuls Ã  travailler.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
RÃ©cupÃ©rer le projet si vous nâ€™avez pas utilisÃ© le bouton proposÃ©
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Interface graphique</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Depuis le terminal</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>La fiche <code>utilitR</code> sur lâ€™<a href="https://book.utilitr.org/03_Fiches_thematiques/Fiche_git_utilisation.html#recuperer-url">utilisation de <code>Git</code></a> explicite la dÃ©marche gÃ©nÃ©rale pour rÃ©cupÃ©rer du code grÃ¢ce Ã  <code>Git</code>. Il est recommandÃ© de lire celle-ci si vous nâ€™Ãªtes pas familier de <code>Git</code>.</p>
<p>Les Ã©tapes suivantes permettront de rÃ©cupÃ©rer le projet:</p>
<p>1ï¸âƒ£ En premier lieu, dans <code>RStudio</code>, crÃ©er un nouveau projet et sÃ©lectionner <code>Version Control</code>.</p>
<p><img src="https://book.utilitr.org/pics_resized/git/create_project_1.png" class="img-fluid"></p>
<p>2ï¸âƒ£ Choisir <code>Git</code>, ce qui devrait ouvrir une fenÃªtre similaire Ã  celle ci-dessous:</p>
<p><img src="https://book.utilitr.org/pics_resized/git/create_project_2.png" class="img-fluid"></p>
<p>3ï¸âƒ£ Dans la fenÃªtre <code>Repository URL</code>, passer la valeur</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>https<span class="sc">:</span><span class="er">//</span>github.com<span class="sc">/</span>inseefrlab<span class="sc">/</span>funathon2024_sujet2.git</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>laisser les valeurs par dÃ©faut qui viennent ensuite et crÃ©er le projet.</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>AprÃ¨s avoir ouvert un terminal dans <code>RStudio</code>, faire</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone https://github.com/inseefrlab/funathon2024_sujet2.git</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>puis, dans lâ€™explorateur de fichiers (fenÃªtre en bas Ã  droite), cliquer sur le fichier <code>RTraffic.Rproj</code> pour ouvrir le projet.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Le projet rÃ©cupÃ©rÃ© comporte de nombreux fichiers. Nous allons progressivement les dÃ©couvrir dans ce tutoriel. A lâ€™heure actuelle, on peut se concentrer sur les fichiers suivants:</p>
<pre><code>|- renv.lock
|- global.R
|- server.R
|- ui.R</code></pre>
<p>Le premier fichier correspond Ã  la liste des <em>packages</em> nÃ©cessaires pour reproduire lâ€™environnement. Il a Ã©tÃ© gÃ©nÃ©rÃ© automatiquement grÃ¢ce Ã  un Ã©cosystÃ¨me <code>renv</code> particuliÃ¨rement adaptÃ© pour assurer la reproductibilitÃ© de projets <code>R</code> (voir la suite).</p>
<p>Les fichiers <code>server.R</code> et <code>ui.R</code> constituent le coeur de notre application <code>Shiny</code>. Ils reprÃ©sentent, respectivement, le moteur de calcul (le serveur) et lâ€™interface utilisateur de notre application. Le fichier <code>global.R</code> stocke un certain nombre dâ€™objets utiles Ã  lâ€™application mais qui nâ€™ont pas besoin dâ€™Ãªtre recalculÃ© Ã  chaque action sur lâ€™interface graphique. Nous allons progressivement construire ces fichiers pendant les diffÃ©rents exercices.</p>
</section>
<section id="installer-les-packages-nÃ©cessaires-pour-ce-tutoriel" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="installer-les-packages-nÃ©cessaires-pour-ce-tutoriel"><span class="header-section-number">2.2</span> Installer les <em>packages</em> nÃ©cessaires pour ce tutoriel</h2>
<section id="principe" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="principe"><span class="header-section-number">2.2.1</span> Principe</h3>
<p>Pour progresser dans ce tutoriel, un certain nombre de <em>packages</em> doivent Ãªtre installÃ©s. Sans eux, mÃªme avec le code de lâ€™application, vous ne serez pas en mesure de reproduire celle-ci.</p>
<p>Les bonnes pratiques pour la gestion de lâ€™environnement sont assez proches en <i class="fa-brands fa-r-project" aria-label="r-project"></i> et <i class="fa-brands fa-python" aria-label="python"></i>. Le principal gÃ©nÃ©ral est quâ€™il existe des outils qui permettent Ã  un utilisateur de lister lâ€™ensemble des packages dans son environnement avec leur version. GrÃ¢ce Ã  cette liste, dâ€™autres personnes pourront reproduire lâ€™application si elles disposent des mÃªmes <em>inputs</em> (le code, les donnÃ©esâ€¦).</p>
<p>En effet, il est important de voir lâ€™application comme le rÃ©sultat de la combinaison de plusieurs ingrÃ©dients. Dans notre cas, nous en avons trois:</p>
<ul>
<li>Du code <code>R</code> ou <code>Python</code> : celui-ci a Ã©tÃ© rÃ©cupÃ©rÃ© par le biais de <code>Git</code></li>
<li>Des Ã©lÃ©ments de configuration:
<ul>
<li>le fichier <code>renv.lock</code> (<code>R</code>) ou <code>requirements.txt</code> (<code>Python</code>) qui permettra de reconstruire notre environnement Ã  lâ€™identique grÃ¢ce Ã  des outils adaptÃ©s<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></li>
<li>le fichier <code>sources.yaml</code> qui liste lâ€™emplacement des sources sur le site <a href="https://www.data.gouv.fr/fr/">data.gouv</a></li>
</ul></li>
<li>Des donnÃ©es: nous Ã©voquerons celles-ci lors de la prochaine partie.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./img/environment.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Illustration du principe de sÃ©paration du code, des donnÃ©es et de la configuration</figcaption>
</figure>
</div>
<p>De maniÃ¨re gÃ©nÃ©rale, câ€™est une bonne pratique de structurer son projet comme une combinaison de ces facteurs. Cela vous amÃ¨nera Ã  faire des projets plus reproductible mais aussi Ã  la structure plus lisible.</p>
<p>Pour les utilisateurs de <code>R</code>, la <a href="https://inseefrlab.github.io/formation-bonnes-pratiques-git-R/">formation de lâ€™Insee aux bonnes pratiques</a> consacre une partie aux environnements reproductibles avec <code>renv</code>. Pour les utilisateurs de <code>Python</code>, le <a href="https://ensae-reproductibilite.github.io/website/chapters/portability.html">cours de mise en production de projets <em>data science</em></a> consacre un chapitre au sujet.</p>
</section>
<section id="crÃ©er-lenvironnement" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="crÃ©er-lenvironnement"><span class="header-section-number">2.2.2</span> CrÃ©er lâ€™environnement</h3>
<p>Si vous avez dÃ©jÃ  tentÃ© de partager un code qui fonctionnait chez vous, il est presque certain que la personne ayant voulu le rÃ©utiliser a rencontrÃ© une erreur si elle a tentÃ© de le faire tourner. Câ€™est tout Ã  fait normal car vous avez distribuÃ© votre code, Ã©ventuellement vos donnÃ©es, mais pas le troisiÃ¨me pilier de lâ€™image prÃ©cÃ©dente, Ã  savoir la configuration de lâ€™environnement dans lequel votre code fonctionnait. La solution la plus fiable, mais peu pratique, serait de donner votre ordinateur Ã  la personne qui tente de rÃ©utiliser votre code. En livrant votre ordinateur, vous fournissez votre environnement de travail mais Ã©galement beaucoup dâ€™Ã©lÃ©ments supplÃ©mentaires qui ne sont pas indispensables Ã  lâ€™application.</p>
<p>Une solution plus simple est de fournir les spÃ©cifications qui ont permis Ã  votre code de fonctionner. Dans un monde idÃ©al, il sâ€™agit de fournir la liste des <em>packages</em> et leur version. Si la personne Ã  qui vous partagez votre code et vos donnÃ©es a cette mÃªme liste de versions de <em>packages</em>, et pas de <em>packages</em> supplÃ©mentaires venant polluer lâ€™environnement, les chances dâ€™avoir la mÃªme application que vous sont trÃ¨s Ã©levÃ©es.</p>
<p><code>renv</code> est un gestionnaire de <em>packages</em> qui permet de faire ces deux opÃ©rations:</p>
<ol type="1">
<li>Enregistrer la liste de <em>packages</em> aprÃ¨s avoir fait tournÃ© un code</li>
<li>Restaurer lâ€™environnement Ã  partir de cette liste</li>
</ol>
<p>En lâ€™occurrence, pour vous, lâ€™important est le second point: pouvoir recrÃ©er lâ€™environnement nÃ©cessaire au bon fonctionnement de lâ€™application. Ceci est trÃ¨s simple grÃ¢ce Ã  la commande</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">restore</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Cette commande doit Ãªtre lancÃ©e depuis la console <code>R</code> ouverte dans le projet qui a Ã©tÃ© rÃ©cupÃ©rÃ©. Lâ€™environnement crÃ©Ã© nâ€™est pas figÃ©. Il est tout Ã  fait possible, ensuite, dâ€™installer des <em>packages</em> supplÃ©mentaires par le biais de <code>install.packages</code>. Lâ€™environnement proposÃ© par notre fichier <code>renv.lock</code> est le minimum requis pour reproduire lâ€™application mais ce nâ€™est pas un environnement figÃ©. Si vous ajoutez des <em>packages</em> utiles pour votre application, avant la phase de mise en production, nâ€™oubliez pas de faire <code>renv::snapshot()</code> pour mettre Ã  jour le fichier <code>renv.lock</code> (câ€™est le point 1. Ã©voquÃ© prÃ©cÃ©demment).</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ce que <code>renv</code> Ã©vite
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>On retrouve parfois sur internet un code similaire Ã  celui-ci :</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A ne pas reproduire chez vous ğŸ˜¨</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"dplyr"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"dplyr"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Câ€™est une gestion artisanale de lâ€™environnement qui nâ€™est pas conseillÃ©e. <code>renv</code> sera plus simple et plus fiable.</p>
</div>
</div>
</div>
<p>Maintenant que nous disposons dâ€™un environnement fonctionnel, nous pouvons avancer sur la conception du projet. La premiÃ¨re Ã©tape est dâ€™explorer les jeux de donnÃ©es que nous utiliserons dans lâ€™application.</p>
</section>
</section>
</section>
<section id="rÃ©cupÃ©rer-les-donnÃ©es" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> RÃ©cupÃ©rer les donnÃ©es</h1>
<p>Les sources sont listÃ©es dans le fichier <code>sources.yaml</code>. Notre application utilisera quatres sources diffÃ©rentes:</p>
<ul>
<li>Le trafic au niveau de chaque aÃ©roport (format CSV)</li>
<li>Le nombre de passagers pour diffÃ©rentes liaisons (format CSV)</li>
<li>Le trafic pour diffÃ©rentes compagnies (format CSV)</li>
<li>Les localisations des aÃ©roports (format geojson)</li>
</ul>
<p>Une bonne pratique, lorsquâ€™on utilise plusieurs sources, est de lister celles-ci dans un fichier <code>YAML</code> plutÃ´t que de les inscrire en brut dans le code. Ce dernier sera plus lisible grÃ¢ce Ã  cette approche.</p>
<details>
<summary>
<p>Voir le fichier <code>sources.yml</code></p>
</summary>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>sources.yml</strong></pre>
</div>
<div class="sourceCode" id="cb6"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Jeux de donnÃ©es </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.data.gouv.fr/fr/datasets/trafic-aerien-commercial-mensuel-francais-par-paire-daeroports-par-sens-depuis-1990/</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">airports</span><span class="kw">:</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">2018</span><span class="kw">:</span><span class="at"> </span><span class="st">"https://www.data.gouv.fr/fr/datasets/r/3b7646ea-276c-4c9b-8151-1e96af2adbf9"</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">2019</span><span class="kw">:</span><span class="at"> </span><span class="st">"https://www.data.gouv.fr/fr/datasets/r/e8efa154-045e-4f8f-a1d7-76a39fa03b7b"</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">2020</span><span class="kw">:</span><span class="at"> </span><span class="st">"https://www.data.gouv.fr/fr/datasets/r/6717f107-be00-4b4b-9706-fa0e5190fb69"</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">2021</span><span class="kw">:</span><span class="at"> </span><span class="st">"https://www.data.gouv.fr/fr/datasets/r/2f9f6e54-e2d7-4e85-b811-2e5e68fa5bca"</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">2022</span><span class="kw">:</span><span class="at"> </span><span class="st">"https://www.data.gouv.fr/fr/datasets/r/f1bd931e-c99e-41ce-865e-9e9785c903ec"</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">liaisons</span><span class="kw">:</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">2018</span><span class="kw">:</span><span class="at"> </span><span class="st">"https://www.data.gouv.fr/fr/datasets/r/9c5354ad-31cb-4217-bc88-fb7c9be22655"</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">2019</span><span class="kw">:</span><span class="at"> </span><span class="st">"https://www.data.gouv.fr/fr/datasets/r/0c0a451e-983b-4f06-9627-b5ff1bccd2fc"</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">2020</span><span class="kw">:</span><span class="at"> </span><span class="st">"https://www.data.gouv.fr/fr/datasets/r/dad30bed-7276-4a67-a1ab-a856e6e01788"</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">2021</span><span class="kw">:</span><span class="at"> </span><span class="st">"https://www.data.gouv.fr/fr/datasets/r/bbf6492d-86ac-43a0-9260-7df2ffdb5a77"</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">2022</span><span class="kw">:</span><span class="at"> </span><span class="st">"https://www.data.gouv.fr/fr/datasets/r/af8950bc-e90a-4b7e-bb81-70c79d4c3846"</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="fu">compagnies</span><span class="kw">:</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">2018</span><span class="kw">:</span><span class="at"> </span><span class="st">"https://www.data.gouv.fr/fr/datasets/r/ddfea6a0-df7e-4402-99fc-165f573f2e10"</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">2019</span><span class="kw">:</span><span class="at"> </span><span class="st">"https://www.data.gouv.fr/fr/datasets/r/8421e029-c8c7-410d-b38c-54455ac3265d"</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">2020</span><span class="kw">:</span><span class="at"> </span><span class="st">"https://www.data.gouv.fr/fr/datasets/r/818eec10-6122-4788-8233-482e779ab837"</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">2021</span><span class="kw">:</span><span class="at"> </span><span class="st">"https://www.data.gouv.fr/fr/datasets/r/0b954774-ccd1-43ec-9b5a-f958fba03e87"</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">2022</span><span class="kw">:</span><span class="at"> </span><span class="st">"https://www.data.gouv.fr/fr/datasets/r/bcec3e1e-940a-4772-bc28-0d7b2b53c718"</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="fu">geojson</span><span class="kw">:</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">airport</span><span class="kw">:</span><span class="at"> </span><span class="st">"https://minio.lab.sspcloud.fr/projet-funathon/2024/sujet2/aeroports.geojson"</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<section id="importer-la-liste-des-sources-disponibles" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="importer-la-liste-des-sources-disponibles"><span class="header-section-number">3.1</span> Importer la liste des sources disponibles</h2>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<i class="bi bi-book"></i> Exercice 1: lire les sources dans <i class="fa-brands fa-r-project" aria-label="r-project"></i>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>Le package <code>yaml</code> comporte une fonction <code>read_yaml</code> pour transformer un fichier <code>YAML</code> en liste imbriquÃ©e. Tester cette fonction sur le fichier <code>sources.yml</code>.</p></li>
<li><p>Transformer ce bout de code en une fonction <code>create_data_list</code> prenant un argument <code>source_file</code> et renvoyant cette liste.</p></li>
</ol>
</div>
</div>
</div>
<details>
<summary>
Voir la solution Ã  cet exercice
</summary>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Creates a 2-levels list of urls, pointing to open source data</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param source_file yaml file containing data urls </span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' @return list (level 1 = concepts, level 2 = year).</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#' @examples</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#'  create_data_list("sources.yml")</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#'  </span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>create_data_list <span class="ot">&lt;-</span> <span class="cf">function</span>(source_file){</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  catalogue <span class="ot">&lt;-</span> yaml<span class="sc">::</span><span class="fu">read_yaml</span>(source_file)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(catalogue)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<p>La solution est dans le fichier <code>R/create_data_list.R</code>. Elle peut Ãªtre importÃ©e dans lâ€™environnement global grÃ¢ce Ã  la commande:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/create_data_list.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="importer-les-premiÃ¨res-bases" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="importer-les-premiÃ¨res-bases"><span class="header-section-number">3.2</span> Importer les premiÃ¨res bases</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>urls <span class="ot">&lt;-</span> <span class="fu">create_data_list</span>(<span class="st">"sources.yml"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<i class="bi bi-book"></i> Exercice 2: dÃ©couvrir les diffÃ©rentes sources
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Cet exercice est, en apparence, un peu long. NÃ©anmoins la premiÃ¨re partie de celui-ci permet la construction dâ€™une fonction gÃ©nÃ©rique dâ€™import des donnÃ©es qui permet ensuite de gagner du temps et dâ€™Ã©viter la redondance de code.</p>
<section id="donnÃ©es-aÃ©roports" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="donnÃ©es-aÃ©roports">DonnÃ©es aÃ©roports</h4>
<ul>
<li>Comme les donnÃ©es sont des CSV europÃ©ens (sÃ©parateur <code>;</code>), utiliser <code>read_csv2</code> du package <code>readr</code> pour lire les donnÃ©es Ã  partir de la liste de fichiers <code>unlist(urls$airports)</code><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>.</li>
<li>Il est recommandÃ© de ne pas laisser les types par dÃ©faut des colonnes mais de figer ceux-ci avec lâ€™argument suivant:</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>col_types <span class="ot">=</span> <span class="fu">cols</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ANMOIS =</span> <span class="fu">col_character</span>(),</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">APT =</span> <span class="fu">col_character</span>(),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">APT_NOM =</span> <span class="fu">col_character</span>(),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">APT_ZON =</span> <span class="fu">col_character</span>(),</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">.default =</span> <span class="fu">col_double</span>()</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>A partir de la variable <code>ANMOIS</code>, crÃ©er les variables <code>an</code> et <code>mois</code>.</li>
</ul>
<details>
<summary>
Aide si vous Ãªtes bloquÃ© sur cette question
</summary>
<p>Pour extraire des Ã©lÃ©ments dâ€™une chaine de caractÃ¨re Ã  partir de la position, il est recommandÃ© dâ€™utiliser la fonction <code>str_sub</code> du package <code>stringr</code>. Pour crÃ©er de nouvelles colonnes, il est recommandÃ© dâ€™utiliser la fonction <code>mutate</code> du package dplyr.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Conseil pour se faciliter la vie ultÃ©rieurement
</div>
</div>
<div class="callout-body-container callout-body">
<p>Il est recommandÃ© dâ€™utiliser <code>str_remove</code> pour retirer les zÃ©ros en dÃ©but de mois qui pourront nous crÃ©er des difficultÃ©s ultÃ©rieurement</p>
</div>
</div>
<p>Si vous Ãªtes toujours bloquÃ©, la solution est donnÃ©e plus bas ğŸ‘‡</p>
</details>
<ul>
<li>CrÃ©er une fonction <code>clean_dataframe</code> qui reprend le code de crÃ©ation des variables <code>an</code> et <code>mois</code>, ajoute une Ã©tape de passage des noms de colonne en minuscule et renvoie le dataframe en sortie</li>
</ul>
<details>
<summary>
Solution
</summary>
<div class="sourceCode" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>clean_dataframe <span class="ot">&lt;-</span> <span class="cf">function</span>(df){</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create an et mois columns</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">an =</span> <span class="fu">str_sub</span>(ANMOIS,<span class="dv">1</span>,<span class="dv">4</span>),</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">mois =</span> <span class="fu">str_sub</span>(ANMOIS,<span class="dv">5</span>,<span class="dv">6</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">mois =</span> <span class="fu">str_remove</span>(mois, <span class="st">"^0+"</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lower case for variable names</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">colnames</span>(df))</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<ul>
<li>CrÃ©er une fonction <code>import_airport_data</code> qui prend en <em>input</em> <code>list_files</code> et intÃ¨gre les deux Ã©tapes prÃ©cÃ©dentes: la lecture des donnÃ©es, le nettoyage avec <code>clean_dataframe</code>.</li>
</ul>
<details>
<summary>
Solution
</summary>
<div class="sourceCode" id="cb12" data-startfrom="1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>import_airport_data <span class="ot">&lt;-</span> <span class="cf">function</span>(list_files){</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  pax_apt_all <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv2</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    list_files, </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_types =</span> <span class="fu">cols</span>(</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">ANMOIS =</span> <span class="fu">col_character</span>(),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">APT =</span> <span class="fu">col_character</span>(),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">APT_NOM =</span> <span class="fu">col_character</span>(),</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">APT_ZON =</span> <span class="fu">col_character</span>(),</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">.default =</span> <span class="fu">col_double</span>()</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">clean_dataframe</span>()</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(pax_apt_all)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Reporter cette fonction dans un fichier <code>R/clean_dataframe.R</code> et faire</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/clean_dataframe.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</section>
<section id="donnÃ©es-compagnies" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="donnÃ©es-compagnies">DonnÃ©es compagnies</h4>
<p>Sur le mÃªme principe, crÃ©er une fonction <code>import_compagnies_data</code> qui effectue la mÃªme suite dâ€™opÃ©rations. Faire nÃ©anmoins attention aux types des colonnes.</p>
<div class="cell">
<details>
<summary>Recommandation de paramÃ¨tre pour read_csv pour lâ€™import de ces fichiers</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>col_types <span class="ot">=</span> <span class="fu">cols</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ANMOIS =</span> <span class="fu">col_character</span>(),</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">CIE =</span> <span class="fu">col_character</span>(),</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">CIE_NOM =</span> <span class="fu">col_character</span>(),</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">CIE_NAT =</span> <span class="fu">col_character</span>(),</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">CIE_PAYS =</span> <span class="fu">col_character</span>(),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">.default =</span> <span class="fu">col_double</span>()</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<details>
<summary>
Solution
</summary>
<div class="sourceCode" id="cb15" data-startfrom="20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r" style="counter-reset: source-line 19;"><span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>import_compagnies_data <span class="ot">&lt;-</span> <span class="cf">function</span>(list_files){</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  pax_cie_all <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv2</span>(</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">file =</span> list_files,</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_types =</span> <span class="fu">cols</span>(</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">ANMOIS =</span> <span class="fu">col_character</span>(),</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">CIE =</span> <span class="fu">col_character</span>(),</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">CIE_NOM =</span> <span class="fu">col_character</span>(),</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">CIE_NAT =</span> <span class="fu">col_character</span>(),</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">CIE_PAYS =</span> <span class="fu">col_character</span>(),</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">.default =</span> <span class="fu">col_double</span>()</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">clean_dataframe</span>()</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(pax_cie_all)</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</section>
<section id="donnÃ©es-liaisons" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="donnÃ©es-liaisons">DonnÃ©es liaisons</h4>
<p>Sur le mÃªme principe, crÃ©er une fonction <code>import_liaisons_data</code> qui effectue la mÃªme suite dâ€™opÃ©rations. Faire nÃ©anmoins attention aux types des colonnes.</p>
<div class="cell">
<details>
<summary>Recommandation de paramÃ¨tre pour read_csv pour lâ€™import de ces fichiers</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>col_types <span class="ot">=</span> <span class="fu">cols</span>(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ANMOIS =</span> <span class="fu">col_character</span>(),</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">LSN =</span> <span class="fu">col_character</span>(),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">LSN_DEP_NOM =</span> <span class="fu">col_character</span>(),</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">LSN_ARR_NOM =</span> <span class="fu">col_character</span>(),</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">LSN_SCT =</span> <span class="fu">col_character</span>(),</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">LSN_FSC =</span> <span class="fu">col_character</span>(),</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">.default =</span> <span class="fu">col_double</span>()</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<details>
<summary>
Solution
</summary>
<div class="sourceCode" id="cb17" data-startfrom="41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r" style="counter-reset: source-line 40;"><span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>import_liaisons_data <span class="ot">&lt;-</span> <span class="cf">function</span>(list_files){</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>  pax_lsn_all <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv2</span>(</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">file =</span> list_files,</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_types =</span> <span class="fu">cols</span>(</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">ANMOIS =</span> <span class="fu">col_character</span>(),</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">LSN =</span> <span class="fu">col_character</span>(),</span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">LSN_DEP_NOM =</span> <span class="fu">col_character</span>(),</span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">LSN_ARR_NOM =</span> <span class="fu">col_character</span>(),</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">LSN_SCT =</span> <span class="fu">col_character</span>(),</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">LSN_FSC =</span> <span class="fu">col_character</span>(),</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">.default =</span> <span class="fu">col_double</span>()</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">clean_dataframe</span>()</span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(pax_lsn_all)</span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</section>
<section id="localisations-des-aÃ©roports" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="localisations-des-aÃ©roports">Localisations des aÃ©roports</h4>
<p>Il sâ€™agit dâ€™un jeu de donnÃ©es spatial. Pour en savoir plus sur ce type de donnÃ©es, il est recommandÃ© de consulter la <a href="https://book.utilitr.org/03_Fiches_thematiques/Fiche_donnees_spatiales.html">fiche <code>utilitR</code></a> sur le sujet ou <a href="https://rgeo.linogaliana.fr/exercises/geospatial-wrangling.html">ce cours introductif</a></p>
<ol type="1">
<li>Utiliser la fonction <code>st_read</code> du package <code>sf</code> pour lire ces donnÃ©es (dont la localisation est stockÃ©e dans la variable <code>urls$geojson$aiport</code>). Stocker lâ€™objet obtenu sous le nom <code>airports_location</code></li>
<li>VÃ©rifier que les donnÃ©es sont bien dans le systÃ¨me de reprÃ©sentation <code>WGS 84</code><a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></li>
</ol>
<details>
<summary>
Aide
</summary>
La fonction Ã  utiliser est <code>sf_crs</code>
</details>
<ol start="3" type="1">
<li>Il est toujours utile de vÃ©rifier que nos donnÃ©es sont bien localisÃ©es oÃ¹ on les attend. Pour cela, il est pertinent de faire une carte avec un fond de carte contextuel, mÃªme si celle-ci nâ€™est pas trÃ¨s soignÃ©e. Pour faire ceci, le plus simple est dâ€™utiliser la <a href="https://rstudio.github.io/leaflet/articles/markers.html">fonction <code>addMarkers</code></a> du package <code>leaflet</code>. Essayez de faire cette carte vous-mÃªmes ou consultez lâ€™aide ci-dessous</li>
</ol>
<details>
<summary>
Code pour faire une carte <code>leaflet</code> minimale
</summary>
<div class="sourceCode" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>(airports_location) <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addMarkers</span>(<span class="at">popup =</span> <span class="sc">~</span>Nom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<p>Reporter toutes ces fonctions dans un fichier <code>R/import_data.R</code>.</p>
</section>
</div>
</div>
</div>
<p>A lâ€™issue de cet exercice, vous devriez avoir le fichier <code>R/import_data.R</code> suivant</p>
<details>
<summary>
Le fichier <code>R/import_data.R</code> attendu
</summary>
<div class="sourceCode" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>import_airport_data <span class="ot">&lt;-</span> <span class="cf">function</span>(list_files){</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  pax_apt_all <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv2</span>(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    list_files, </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_types =</span> <span class="fu">cols</span>(</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">ANMOIS =</span> <span class="fu">col_character</span>(),</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">APT =</span> <span class="fu">col_character</span>(),</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">APT_NOM =</span> <span class="fu">col_character</span>(),</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">APT_ZON =</span> <span class="fu">col_character</span>(),</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">.default =</span> <span class="fu">col_double</span>()</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">clean_dataframe</span>()</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(pax_apt_all)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>import_compagnies_data <span class="ot">&lt;-</span> <span class="cf">function</span>(list_files){</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>  pax_cie_all <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv2</span>(</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">file =</span> list_files,</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_types =</span> <span class="fu">cols</span>(</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">ANMOIS =</span> <span class="fu">col_character</span>(),</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">CIE =</span> <span class="fu">col_character</span>(),</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">CIE_NOM =</span> <span class="fu">col_character</span>(),</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">CIE_NAT =</span> <span class="fu">col_character</span>(),</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">CIE_PAYS =</span> <span class="fu">col_character</span>(),</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">.default =</span> <span class="fu">col_double</span>()</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">clean_dataframe</span>()</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(pax_cie_all)</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>import_liaisons_data <span class="ot">&lt;-</span> <span class="cf">function</span>(list_files){</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>  pax_lsn_all <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv2</span>(</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">file =</span> list_files,</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_types =</span> <span class="fu">cols</span>(</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">ANMOIS =</span> <span class="fu">col_character</span>(),</span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">LSN =</span> <span class="fu">col_character</span>(),</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">LSN_DEP_NOM =</span> <span class="fu">col_character</span>(),</span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">LSN_ARR_NOM =</span> <span class="fu">col_character</span>(),</span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">LSN_SCT =</span> <span class="fu">col_character</span>(),</span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">LSN_FSC =</span> <span class="fu">col_character</span>(),</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">.default =</span> <span class="fu">col_double</span>()</span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">clean_dataframe</span>()</span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(pax_lsn_all)</span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<p>La carte <code>leaflet</code> que vous devriez avoir obtenue Ã  la fin de lâ€™exercice est la suivante:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>(airports_location) <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addMarkers</span>(<span class="at">popup =</span> <span class="sc">~</span>Nom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-01f74c02ec1361187cc7" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-01f74c02ec1361187cc7">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addMarkers","args":[[-23.37,-22.59,-22.43,-22.26,-22.01,-21.48,-20.89,-20.77,-20.64,-17.55,-17.49,-16.72,-16.69,-16.44,-16.43,-16.05,-15.12,-14.95,-12.81,-9.77,-8.800000000000001,3.66,4.82,14.59,16.27,17.9,18.1,41.5,41.92,42.52,42.55,42.74,43.1,43.19,43.32,43.38,43.44,43.47,43.55,43.56,43.58,43.64,43.67,44.83,44.9,45.04,45.73,45.79,46.76,47.04,47.16,47.31,47.43,47.59,48.07,48.45,48.54,48.72,48.77,48.97,49.01,49.17,49.45,50.56],[-149.52,167.46,-151.36,166.47,166.21,168.04,55.51,167.24,166.57,-149.61,-149.76,-151.47,-151.02,-151.75,-152.24,-145.66,-148.23,-147.66,45.28,-139.01,-140.23,-54.04,-52.36,-61,-61.53,-62.84,-63.05,9.1,8.800000000000001,8.789999999999999,9.48,2.87,6.15,0.01,3.35,-0.42,5.22,-1.53,6.95,2.29,3.96,1.37,7.22,-0.72,2.42,1.49,5.08,3.16,-56.17,5.44,-1.61,-2.16,0.72,7.53,-1.73,-4.42,7.63,2.38,4.21,2.44,2.55,-0.45,2.11,3.09],null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},["TUBUAI MATAURA","ILE DES PINS","RURUTU","NOUMEA MAGENTA","NOUMEA LA TONTOUTA","MARE","LA REUNION-ROLAND GARROS","LIFOU","OUVEA","TAHITI FAA'A","MOOREA","RAIATEA","HUAHINE","BORA BORA","MAUPITI","FAKARAVA","TIKEHAU","RANGIROA","MAYOTTE-DZAOUDZI-PAMANDZI","HIVA OA-ATUONA","NUKU HIVA","MARIPASOULA","CAYENNE-FELIX EBOUE","MARTINIQUE-AIME CESAIRE","POINTE-A-PITRE-LE RAIZET","ST-BARTHELEMY","ST-MARTIN-GRAND-CASE","FIGARI-SUD-CORSE","AJACCIO-NAPOLEON-BONAPARTE","CALVI-STE-CATHERINE","BASTIA-PORETTA","PERPIGNAN-RIVESALTES","TOULON-HYERES","TARBES-LOURDES-PYRENEES","BEZIERS-VIAS","PAU-PYRENEES","MARSEILLE-PROVENCE","BIARRITZ-PAYS-BASQUE","CANNES-MANDELIEU","CASTRES-MAZAMET","MONTPELLIER-MEDITERRANEE","TOULOUSE-BLAGNAC","NICE-COTE D'AZUR","BORDEAUX-MERIGNAC","AURILLAC","BRIVE-SOUILLAC","LYON-ST-EXUPERY","CLERMONT-FERRAND-AUVERGNE","ST-PIERRE-POINTE BLANCHE","DOLE-TAVAUX","NANTES-ATLANTIQUE","ST-NAZAIRE-MONTOIR","TOURS-VAL DE LOIRE","BALE-MULHOUSE","RENNES-ST-JACQUES","BREST-BRETAGNE","STRASBOURG-ENTZHEIM","PARIS-ORLY","CHALONS-VATRY","PARIS-LE BOURGET","PARIS-CHARLES DE GAULLE","CAEN-CARPIQUET","BEAUVAIS-TILLE","LILLE-LESQUIN"],null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[-23.37,50.56],"lng":[-152.24,168.04]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>A lâ€™issue de lâ€™exercice, le code centralisÃ© dans le script <code>R/import_data.R</code> peut Ãªtre importÃ© via le code suivant</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/import_data.R"</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Vous pouvez initier un script nommÃ© <code>main.R</code> avec les lignes suivante:</p>
<div class="sourceCode" id="cb22" data-startfrom="24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r" style="counter-reset: source-line 23;"><span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>MONTHS_LIST <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data ----------------------------------</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>urls <span class="ot">&lt;-</span> <span class="fu">create_data_list</span>(<span class="st">"./sources.yml"</span>)</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>pax_apt_all <span class="ot">&lt;-</span> <span class="fu">import_airport_data</span>(<span class="fu">unlist</span>(urls<span class="sc">$</span>airports))</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>pax_cie_all <span class="ot">&lt;-</span> <span class="fu">import_compagnies_data</span>(<span class="fu">unlist</span>(urls<span class="sc">$</span>compagnies))</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>pax_lsn_all <span class="ot">&lt;-</span> <span class="fu">import_liaisons_data</span>(<span class="fu">unlist</span>(urls<span class="sc">$</span>liaisons))</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>airports_location <span class="ot">&lt;-</span> <span class="fu">st_read</span>(urls<span class="sc">$</span>geojson<span class="sc">$</span>airport)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>en les faisant prÃ©cÃ©der de lâ€™import des scripts que nous avons dÃ©jÃ  crÃ©Ã© dans le dossier <code>R</code>:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/create_data_list.R"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/import_data.R"</span>)  </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/clean_dataframe.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Une bonne pratique est de tester son script dans une session vierge. Cela amÃ¨ne Ã  construire pas Ã  pas une chaine plus reproductible. Pour cela,</p>
<ul>
<li>Aller dans les options de <code>R</code> via <code>Tools &gt; Global Options</code> et dÃ©cocher la case <code>Restore .RData into workspace at setup</code></li>
<li>RedÃ©marrer votre session <code>R</code> via le menu <code>Session &gt; Restart R</code> ou le raccourci <kbd>CTRL</kbd>+<kbd>SHIFT</kbd>+<kbd>F10</kbd></li>
</ul>
<p>Et exÃ©cuter votre fichier <code>main.R</code>. Vous devriez rencontrer des erreurs car nous nâ€™avons pas gÃ©rÃ© les import de librairies dans ce script puisque notre session actuelle ne bÃ©nÃ©ficie plus des import antÃ©rieurs.</p>
<p>Une bonne pratique pour comprendre cette exigence de reproductibilitÃ© est dâ€™itÃ©rativement ajouter les librairies utiles Ã  mesure quâ€™on rencontre des erreurs (notre code Ã©tant trÃ¨s rapide Ã  tourner, cette logique dâ€™essai-erreur nâ€™est pas trÃ¨s coÃ»teuse). Si vous ne dÃ©sirez pas faire ceci (dommage, câ€™est un bon exercice), vous pouvez trouver les imports de packages Ã  faire pour que notre script soit reproductible.</p>
<details>
<summary>
Lâ€™environnement minimal de reproductibilitÃ© pour que le script <code>main.R</code> fonctionne
</summary>
<div class="sourceCode" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<p>Ces librairies sont Ã  Ã©crire au dÃ©but de <code>main.R</code>.</p>
</section>
</section>
<section id="exploration-des-donnÃ©es" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Exploration des donnÃ©es</h1>
<section id="le-trafic-par-aÃ©roport" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="le-trafic-par-aÃ©roport"><span class="header-section-number">4.1</span> Le trafic par aÃ©roport</h2>
<p>Pour commencer, nous allons prototyper la production dâ€™une figure sur le trafic aÃ©rien au niveau dâ€™un aÃ©roport. Cela nous facilitera ensuite lâ€™intÃ©gration dans une application interactive.</p>
<p>Pour cela, nous allons crÃ©er les deux objets temporaires suivants</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>liste_aeroports <span class="ot">&lt;-</span> <span class="fu">unique</span>(pax_apt_all<span class="sc">$</span>apt)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>default_airport <span class="ot">&lt;-</span> liste_aeroports[<span class="dv">1</span>]</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>default_airport</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "FMCZ"</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<i class="bi bi-book"></i> Exercice 3: graphiques de frÃ©quentation des aÃ©roports
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ol type="1">
<li>CrÃ©er une variable <code>trafic</code> Ã©gale <code>apt_pax_dep + apt_pax_tr + apt_pax_arr</code></li>
<li>Ne conserver que les donnÃ©es relatives Ã  lâ€™aÃ©roport <code>default_airport</code></li>
<li>CrÃ©er une variable <code>date</code> qui utilise les colonnes <code>an</code> et <code>mois</code>. Cette variable de date doit Ãªtre au format <code>date</code>, pas au format <code>chr</code>
<details>
<summary>
EnchaÃ®nement des opÃ©rations attendues Ã  cette Ã©tape
</summary></details></li>
</ol>
<div class="sourceCode" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/import_data.R"</span>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/create_data_list.R"</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/clean_dataframe.R"</span>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/figures.R"</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data ----------------------------------</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>urls <span class="ot">&lt;-</span> <span class="fu">create_data_list</span>(<span class="st">"./sources.yml"</span>)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>pax_apt_all <span class="ot">&lt;-</span> <span class="fu">import_airport_data</span>(<span class="fu">unlist</span>(urls<span class="sc">$</span>airports))</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>pax_cie_all <span class="ot">&lt;-</span> <span class="fu">import_compagnies_data</span>(<span class="fu">unlist</span>(urls<span class="sc">$</span>compagnies))</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>pax_lsn_all <span class="ot">&lt;-</span> <span class="fu">import_liaisons_data</span>(<span class="fu">unlist</span>(urls<span class="sc">$</span>liaisons))</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>airports_location <span class="ot">&lt;-</span> <span class="fu">st_read</span>(urls<span class="sc">$</span>geojson<span class="sc">$</span>airport)</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>liste_aeroports <span class="ot">&lt;-</span> <span class="fu">unique</span>(pax_apt_all<span class="sc">$</span>apt)</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>default_airport <span class="ot">&lt;-</span> liste_aeroports[<span class="dv">1</span>]</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>trafic_aeroports <span class="ot">&lt;-</span> pax_apt_all <span class="sc">%&gt;%</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trafic =</span> apt_pax_dep <span class="sc">+</span> apt_pax_tr <span class="sc">+</span> apt_pax_arr) <span class="sc">%&gt;%</span></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(apt <span class="sc">%in%</span> default_airport) <span class="sc">%&gt;%</span></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(anmois, <span class="st">"01"</span>, <span class="at">sep=</span><span class="st">""</span>), <span class="at">format =</span> <span class="st">"%Y%m%d"</span>)</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<ol start="4" type="1">
<li>Faire une figure <code>ggplot</code> toute simple pour voir la dynamique des donnÃ©es afin dâ€™obtenir une figure similaire Ã  celle-ci</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>figure_ggplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Nous allons faire une application interactive par la suite. Il est donc plus intÃ©ressant dâ€™avoir une figure un minimum rÃ©active pour impliquer lâ€™utilisateur de lâ€™application.</p>
<ol start="5" type="1">
<li>Il est donc plus pertinent de faire une figure avec la librairie <code>plotly</code>. Pour cela, vous pouvez vous inspirer de <a href="https://plotly.com/r/line-charts/">cette page</a></li>
</ol>
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-1efd32ac99511f99593b" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-1efd32ac99511f99593b">{"x":{"visdat":{"23f746afaf00":["function () ","plotlyVisDat"]},"cur_data":"23f746afaf00","attrs":{"23f746afaf00":{"x":{},"y":{},"text":{},"hovertemplate":"<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","mode":"lines+markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"date"},"yaxis":{"domain":[0,1],"automargin":true,"title":"trafic"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01"],"y":[33287,24714,26961,26224,30432,31595,49489,51680,29485,33197,22810,37085,31356,23307,29516,27718,24752,31779,45422,45361,29509,32017,24739,39382,34512,23982,21577,636,1396,4228,14969,17913,12227,15812,11596,28325,24765,7009,5029,5993,9618,16516,36841,38763,24106,25236,20873,34227,29441,19869,25972,19815,28922,31479,50968,50499,31330,34781,26573,43846],"text":["MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY","MAYOTTE-MARCEL HENRY"],"hovertemplate":["<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}","<i>AÃ©roport:<\/i> %{text}<br>Trafic: %{y}"],"mode":"lines+markers","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<details>
<summary>
Le code pour gÃ©nÃ©rer la figure
</summary>
<div class="sourceCode" id="cb29" data-startfrom="15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r" style="counter-reset: source-line 14;"><span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>pax_apt_all <span class="ot">&lt;-</span> <span class="fu">import_airport_data</span>(<span class="fu">unlist</span>(urls<span class="sc">$</span>airports))</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>pax_cie_all <span class="ot">&lt;-</span> <span class="fu">import_compagnies_data</span>(<span class="fu">unlist</span>(urls<span class="sc">$</span>compagnies))</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>pax_lsn_all <span class="ot">&lt;-</span> <span class="fu">import_liaisons_data</span>(<span class="fu">unlist</span>(urls<span class="sc">$</span>liaisons))</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>airports_location <span class="ot">&lt;-</span> <span class="fu">st_read</span>(urls<span class="sc">$</span>geojson<span class="sc">$</span>airport)</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>liste_aeroports <span class="ot">&lt;-</span> <span class="fu">unique</span>(pax_apt_all<span class="sc">$</span>apt)</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>default_airport <span class="ot">&lt;-</span> liste_aeroports[<span class="dv">1</span>]</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>trafic_aeroports <span class="ot">&lt;-</span> pax_apt_all <span class="sc">%&gt;%</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trafic =</span> apt_pax_dep <span class="sc">+</span> apt_pax_tr <span class="sc">+</span> apt_pax_arr) <span class="sc">%&gt;%</span></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(apt <span class="sc">%in%</span> default_airport) <span class="sc">%&gt;%</span></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(anmois, <span class="st">"01"</span>, <span class="at">sep=</span><span class="st">""</span>), <span class="at">format =</span> <span class="st">"%Y%m%d"</span>)</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a><span class="co"># VALORISATIONS ----------------------------------------------</span></span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>figure_ggplot <span class="ot">&lt;-</span> trafic_aeroports <span class="sc">%&gt;%</span></span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(.) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> trafic))</span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>figure_plotly <span class="ot">&lt;-</span> <span class="fu">plot_airport_line</span>(trafic_aeroports,default_airport)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
<p>Le code complet pour rÃ©pliquer cet exercice est donnÃ© ci-dessous.</p>
<details>
<summary>
Code de lâ€™exercice
</summary>
<div class="sourceCode" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/import_data.R"</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/create_data_list.R"</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/clean_dataframe.R"</span>)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/figures.R"</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data ----------------------------------</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>urls <span class="ot">&lt;-</span> <span class="fu">create_data_list</span>(<span class="st">"./sources.yml"</span>)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>pax_apt_all <span class="ot">&lt;-</span> <span class="fu">import_airport_data</span>(<span class="fu">unlist</span>(urls<span class="sc">$</span>airports))</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>pax_cie_all <span class="ot">&lt;-</span> <span class="fu">import_compagnies_data</span>(<span class="fu">unlist</span>(urls<span class="sc">$</span>compagnies))</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>pax_lsn_all <span class="ot">&lt;-</span> <span class="fu">import_liaisons_data</span>(<span class="fu">unlist</span>(urls<span class="sc">$</span>liaisons))</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>airports_location <span class="ot">&lt;-</span> <span class="fu">st_read</span>(urls<span class="sc">$</span>geojson<span class="sc">$</span>airport)</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>liste_aeroports <span class="ot">&lt;-</span> <span class="fu">unique</span>(pax_apt_all<span class="sc">$</span>apt)</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>default_airport <span class="ot">&lt;-</span> liste_aeroports[<span class="dv">1</span>]</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>trafic_aeroports <span class="ot">&lt;-</span> pax_apt_all <span class="sc">%&gt;%</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trafic =</span> apt_pax_dep <span class="sc">+</span> apt_pax_tr <span class="sc">+</span> apt_pax_arr) <span class="sc">%&gt;%</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(apt <span class="sc">%in%</span> default_airport) <span class="sc">%&gt;%</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(anmois, <span class="st">"01"</span>, <span class="at">sep=</span><span class="st">""</span>), <span class="at">format =</span> <span class="st">"%Y%m%d"</span>)</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a><span class="co"># VALORISATIONS ----------------------------------------------</span></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>figure_ggplot <span class="ot">&lt;-</span> trafic_aeroports <span class="sc">%&gt;%</span></span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(.) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> trafic))</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>figure_plotly <span class="ot">&lt;-</span> <span class="fu">plot_airport_line</span>(trafic_aeroports,default_airport)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<p>Nous proposons de le transformer en fonction, ce sera plus simple Ã  intÃ©grer ultÃ©rieurement dans notre application</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<i class="bi bi-book"></i> Exercice 3b: une fonction de production graphique
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Transformer le code ci-dessus en une fonction afin que</p>
<ul>
<li>les <em>inputs</em> soient les suivants: un <em>dataframe</em>, un aÃ©roport Ã  sÃ©lectionner</li>
<li>la sortie soit notre figure <code>plotly</code></li>
</ul>
<p>Tester la fonction sur dâ€™autres aÃ©roports de la liste. Quand vous Ãªtes satisfaits de celle-ci, dÃ©placer la dÃ©finition de cette fonction dans <code>R/figures.R</code></p>
</div>
</div>
</div>
<details>
<summary>
Fichier <code>R/figures.R</code> Ã  lâ€™issue de cet exercice
</summary>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R/figures.R</strong></pre>
</div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>plot_airport_line <span class="ot">&lt;-</span> <span class="cf">function</span>(df, selected_airport){</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  trafic_aeroports <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">trafic =</span> apt_pax_dep <span class="sc">+</span> apt_pax_tr <span class="sc">+</span> apt_pax_arr) <span class="sc">%&gt;%</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(apt <span class="sc">%in%</span> selected_airport) <span class="sc">%&gt;%</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(anmois, <span class="st">"01"</span>, <span class="at">sep=</span><span class="st">""</span>), <span class="at">format =</span> <span class="st">"%Y%m%d"</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  figure_plotly <span class="ot">&lt;-</span> trafic_aeroports <span class="sc">%&gt;%</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot_ly</span>(</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="sc">~</span>date, <span class="at">y =</span> <span class="sc">~</span>trafic,</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">text =</span> <span class="sc">~</span>apt_nom,</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">hovertemplate =</span> <span class="fu">paste</span>(<span class="st">"&lt;i&gt;AÃ©roport:&lt;/i&gt; %{text}&lt;br&gt;Trafic: %{y}"</span>) ,</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines+markers'</span>)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(figure_plotly)</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<p>Par la suite, nous pouvons ajouter la ligne suivante Ã  notre fichier <code>main.R</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/figures.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>et utiliser cette fonction Ã  la fin du fichier.</p>
<details>
<summary>
Fichier <code>main.R</code> Ã  lâ€™issue de cet exercice
</summary>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>main.R</strong></pre>
</div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/import_data.R"</span>)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/create_data_list.R"</span>)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/clean_dataframe.R"</span>)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/figures.R"</span>)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data ----------------------------------</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>urls <span class="ot">&lt;-</span> <span class="fu">create_data_list</span>(<span class="st">"./sources.yml"</span>)</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>pax_apt_all <span class="ot">&lt;-</span> <span class="fu">import_airport_data</span>(<span class="fu">unlist</span>(urls<span class="sc">$</span>airports))</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>pax_cie_all <span class="ot">&lt;-</span> <span class="fu">import_compagnies_data</span>(<span class="fu">unlist</span>(urls<span class="sc">$</span>compagnies))</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>pax_lsn_all <span class="ot">&lt;-</span> <span class="fu">import_liaisons_data</span>(<span class="fu">unlist</span>(urls<span class="sc">$</span>liaisons))</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>airports_location <span class="ot">&lt;-</span> <span class="fu">st_read</span>(urls<span class="sc">$</span>geojson<span class="sc">$</span>airport)</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>liste_aeroports <span class="ot">&lt;-</span> <span class="fu">unique</span>(pax_apt_all<span class="sc">$</span>apt)</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>default_airport <span class="ot">&lt;-</span> liste_aeroports[<span class="dv">1</span>]</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>trafic_aeroports <span class="ot">&lt;-</span> pax_apt_all <span class="sc">%&gt;%</span></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trafic =</span> apt_pax_dep <span class="sc">+</span> apt_pax_tr <span class="sc">+</span> apt_pax_arr) <span class="sc">%&gt;%</span></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(apt <span class="sc">%in%</span> default_airport) <span class="sc">%&gt;%</span></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(anmois, <span class="st">"01"</span>, <span class="at">sep=</span><span class="st">""</span>), <span class="at">format =</span> <span class="st">"%Y%m%d"</span>)</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a><span class="co"># VALORISATIONS ----------------------------------------------</span></span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>figure_ggplot <span class="ot">&lt;-</span> trafic_aeroports <span class="sc">%&gt;%</span></span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(.) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> trafic))</span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>figure_plotly <span class="ot">&lt;-</span> <span class="fu">plot_airport_line</span>(trafic_aeroports,default_airport)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
</section>
<section id="tableau-html-pour-afficher-des-donnÃ©es" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="tableau-html-pour-afficher-des-donnÃ©es"><span class="header-section-number">4.2</span> Tableau HTML pour afficher des donnÃ©es</h2>
<p>La premiÃ¨re valorisation que nous intÃ©grerons dans notre application est le modÃ¨le de figure ci-dessus. La deuxiÃ¨me sera un tableau permettant de visualiser certaines donnÃ©es directement dans le <em>dashboard</em>.</p>
<p>Pour le prochain exercice, vous pourrez utiliser ces objets</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>YEARS_LIST  <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="dv">2018</span><span class="sc">:</span><span class="dv">2022</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>MONTHS_LIST <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<i class="bi bi-book"></i> Exercice 4a: prÃ©parer les donnÃ©es avant de faire un beau tableau
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Nous allons intÃ©grer dans notre application deux tableaux de statistiques descriptives.</p>
<ol type="1">
<li>Choisir un mois et une annÃ©e Ã  partir des objets <code>YEARS_LIST</code> et <code>MONTHS_LIST</code> pour faire un filtre sur le <em>dataframe</em> <code>pax_apt_all</code>. Une fois que vous Ãªtes satisfaits, transformer cela en fonction <code>create_data_from_input</code> prenant en argument un <em>dataframe</em>, une annÃ©e et un mois</li>
</ol>
<details>
<summary>
Code de lâ€™exercice
</summary>
<div class="sourceCode" id="cb35" data-startfrom="1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>create_data_from_input <span class="ot">&lt;-</span> <span class="cf">function</span>(data, years, months){</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(mois <span class="sc">%in%</span> months, an <span class="sc">%in%</span> years)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(data)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<ol start="2" type="1">
<li>Pour chaque aÃ©roport, calculer le nombre total de passager. Rapporter cette statistique en million de personnes. Puis classer les aÃ©rports du plus frÃ©quentÃ© au moins frÃ©quentÃ©. Une fois que vous Ãªtes satisfaits de votre chaine dâ€™opÃ©ration, crÃ©er une fonction <code>summary_stat_airport</code>.</li>
</ol>
<details>
<summary>
Code de lâ€™exercice
</summary>
<div class="sourceCode" id="cb36" data-startfrom="8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r" style="counter-reset: source-line 7;"><span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  table2 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(apt, apt_nom) <span class="sc">%&gt;%</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">paxdep =</span> <span class="fu">round</span>(<span class="fu">sum</span>(apt_pax_dep, <span class="at">na.rm =</span> T),<span class="dv">3</span>),</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">paxarr =</span> <span class="fu">round</span>(<span class="fu">sum</span>(apt_pax_arr, <span class="at">na.rm =</span> T),<span class="dv">3</span>),</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">paxtra =</span> <span class="fu">round</span>(<span class="fu">sum</span>(apt_pax_tr, <span class="at">na.rm =</span> T),<span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(paxdep)) <span class="sc">%&gt;%</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(table2)</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="er">}</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<ol start="3" type="1">
<li>Voici une fonction pour faire le mÃªme type dâ€™opÃ©ration sur la base des liaisons.</li>
</ol>
<details>
<summary>
Code de lâ€™exercice
</summary>
<div class="sourceCode" id="cb37" data-startfrom="21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r" style="counter-reset: source-line 20;"><span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>  agg_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(lsn_fsc) <span class="sc">%&gt;%</span></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">paxloc =</span> <span class="fu">round</span>(<span class="fu">sum</span>(lsn_pax_loc, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">*</span><span class="fl">1e-6</span>,<span class="dv">3</span>)</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(agg_data)</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a><span class="er">}</span></span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<p>Reporter les fonctions crÃ©Ã©es dans cet exercice dans un script <code>divers_functions.R</code>. Enrichir le script <code>main.R</code> pour utiliser celles-ci en crÃ©ant les <em>dataframes</em> adÃ©quats (correction ci-dessous)</p>
</div>
</div>
</div>
<p>Voici une proposition de script <code>main.R</code> Ã  lâ€™issue de cet exercice</p>
<details>
<summary>
Code de lâ€™exercice
</summary>
<div class="sourceCode" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/import_data.R"</span>)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/create_data_list.R"</span>)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/clean_dataframe.R"</span>)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/divers_functions.R"</span>)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/figures.R"</span>)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>YEARS_LIST  <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="dv">2018</span><span class="sc">:</span><span class="dv">2022</span>)</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>MONTHS_LIST <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>year <span class="ot">&lt;-</span> YEARS_LIST[<span class="dv">1</span>]</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>month <span class="ot">&lt;-</span> MONTHS_LIST[<span class="dv">1</span>]</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data ----------------------------------</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>urls <span class="ot">&lt;-</span> <span class="fu">create_data_list</span>(<span class="st">"./sources.yml"</span>)</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>pax_apt_all <span class="ot">&lt;-</span> <span class="fu">import_airport_data</span>(<span class="fu">unlist</span>(urls<span class="sc">$</span>airports))</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>pax_cie_all <span class="ot">&lt;-</span> <span class="fu">import_compagnies_data</span>(<span class="fu">unlist</span>(urls<span class="sc">$</span>compagnies))</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>pax_lsn_all <span class="ot">&lt;-</span> <span class="fu">import_liaisons_data</span>(<span class="fu">unlist</span>(urls<span class="sc">$</span>liaisons))</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>airports_location <span class="ot">&lt;-</span> <span class="fu">st_read</span>(urls<span class="sc">$</span>geojson<span class="sc">$</span>airport)</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>liste_aeroports <span class="ot">&lt;-</span> <span class="fu">unique</span>(pax_apt_all<span class="sc">$</span>apt)</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>default_airport <span class="ot">&lt;-</span> liste_aeroports[<span class="dv">1</span>]</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a><span class="co"># OBJETS NECESSAIRES A L'APPLICATION ------------------------</span></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>trafic_aeroports <span class="ot">&lt;-</span> pax_apt_all <span class="sc">%&gt;%</span></span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trafic =</span> apt_pax_dep <span class="sc">+</span> apt_pax_tr <span class="sc">+</span> apt_pax_arr) <span class="sc">%&gt;%</span></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(apt <span class="sc">%in%</span> default_airport) <span class="sc">%&gt;%</span></span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(anmois, <span class="st">"01"</span>, <span class="at">sep=</span><span class="st">""</span>), <span class="at">format =</span> <span class="st">"%Y%m%d"</span>)</span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>stats_aeroports <span class="ot">&lt;-</span> <span class="fu">summary_stat_airport</span>(</span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">create_data_from_input</span>(pax_apt_all, year, month)</span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>stats_liaisons  <span class="ot">&lt;-</span> <span class="fu">summary_stat_liaisons</span>(</span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">create_data_from_input</span>(pax_lsn_all, year, month)</span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a><span class="co"># VALORISATIONS ----------------------------------------------</span></span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a>figure_plotly <span class="ot">&lt;-</span> <span class="fu">plot_airport_line</span>(trafic_aeroports,default_airport)</span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<p>Nous avons maintenant tous les ingrÃ©dients pour faire un tableau de statistiques descriptives lisible et esthÃ©tique. Pour cela, nous allons utiliser le <em>package</em> <a href="https://gt.rstudio.com/"><code>GT</code></a>. Avant de crÃ©er cette table, nous allons crÃ©er une colonne supplÃ©mentaire:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>stats_aeroports_table <span class="ot">&lt;-</span> stats_aeroports <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name_clean =</span> <span class="fu">paste0</span>(<span class="fu">str_to_sentence</span>(apt_nom), <span class="st">" _("</span>, apt, <span class="st">")_"</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(name_clean, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Celle-ci nous permettra, une fois mise en forme, dâ€™avoir une colonne plus esthÃ©tique.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<i class="bi bi-book"></i> Exercice 4b: un beau tableau (enfin !)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Les diffÃ©rentes questions vont permettre de construire et formatter progressivement notre tableau. Si vous Ãªtes bloquÃ©s, les rÃ©ponses sont ci-dessous dans des menus dÃ©roulants.</p>
<ol type="1">
<li>En premier lieu, utiliser <code>GT</code> pour faire un tableau basique sur le <em>dataframe</em> <code>stats_aeroports_table</code>. Nâ€™utiliser aucune option, celles-ci vont Ãªtre progressivement ajoutÃ©es.</li>
<li>Retirer les colonnes <code>apt</code> et <code>apt_nom</code> de notre table.</li>
</ol>
<details>
<summary>
Il y a plusieurs maniÃ¨res de faire, voici un indice sur la â€œmeilleureâ€
</summary>
Il est possible dâ€™utiliser des fonctions de sÃ©lection de colonnes issues du <em>tidyverse</em> dans <code>gt</code>, notamment la fonction <code>starts_with</code> (Ã  ne pas confondre avec celle de <code>stringr</code>)
</details>
<ol start="3" type="1">
<li><p>Formatter les colonnes numÃ©riques (pour la sÃ©lection des colonnes numÃ©riques, voir lâ€™indice ci-dessus). En consultant la documentation de <code>gt</code>, appliquer lâ€™option qui permet de rendre plus concise la notation des milliers (K) et millions (M).</p></li>
<li><p>Utiliser <code>fmt_markdown</code> pour appliquer une mise en forme adaptÃ©e Ã  la colonne <code>name_clean</code></p></li>
<li><p>Mettre en forme les noms de colonne (<code>cols_labels</code>), le titre (<code>tab_header</code>) et la couleur de la partie supÃ©rieure du tableau (<code>tab_style</code>), les notes (<code>tab_source_note</code>) pour avoir un tableau esthÃ©thique et informatif</p></li>
<li><p>Transformer la table en tableau interactif avec <code>opt_interactive</code><a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p></li>
</ol>
</div>
</div>
</div>
<p>Les rÃ©ponses aux diffÃ©rentes questions sont donnÃ©es de maniÃ¨re successives ci-dessous. La table finale, obtenue Ã  lâ€™issue de lâ€™exercice est la suivante:</p>
<div class="cell">
<details>
<summary>RÃ©ponse question 1</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>table_aeroports <span class="ot">&lt;-</span> <span class="fu">gt</span>(stats_aeroports_table)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>table_aeroports</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>RÃ©ponse question 2</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>table_aeroports <span class="ot">&lt;-</span> table_aeroports <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_hide</span>(<span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"apt"</span>))</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>table_aeroports</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>RÃ©ponse question 3</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>table_aeroports <span class="ot">&lt;-</span> table_aeroports <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"pax"</span>), <span class="at">suffixing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>table_aeroports</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>RÃ©ponse question 4</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>table_aeroports <span class="ot">&lt;-</span> table_aeroports <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_markdown</span>(<span class="at">columns =</span> <span class="st">"name_clean"</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>table_aeroports</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>RÃ©ponse question 5</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>table_aeroports <span class="ot">&lt;-</span> table_aeroports <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">name_clean =</span> <span class="fu">md</span>(<span class="st">"**AÃ©roport**"</span>),</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">paxdep =</span> <span class="fu">md</span>(<span class="st">"**DÃ©parts**"</span>),</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">paxarr =</span> <span class="fu">md</span>(<span class="st">"**ArrivÃ©e**"</span>),</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">paxtra =</span> <span class="fu">md</span>(<span class="st">"**Transit**"</span>)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">md</span>(<span class="st">"**Statistiques de frÃ©quentation**"</span>),</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">md</span>(<span class="st">"Classement des aÃ©roports"</span>)</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"powderblue"</span>),</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_title</span>()</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_source_note</span>(<span class="at">source_note =</span> <span class="fu">md</span>(<span class="st">"_Source: DGAC, Ã  partir des donnÃ©es sur data.gouv.fr_"</span>))</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>table_aeroports</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>RÃ©ponse question 6</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>table_aeroports <span class="ot">&lt;-</span> table_aeroports <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">opt_interactive</span>()</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>table_aeroports</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="srotsyjivr" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#srotsyjivr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#srotsyjivr thead, #srotsyjivr tbody, #srotsyjivr tfoot, #srotsyjivr tr, #srotsyjivr td, #srotsyjivr th {
  border-style: none;
}

#srotsyjivr p {
  margin: 0;
  padding: 0;
}

#srotsyjivr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#srotsyjivr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#srotsyjivr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#srotsyjivr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#srotsyjivr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#srotsyjivr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#srotsyjivr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#srotsyjivr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#srotsyjivr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#srotsyjivr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#srotsyjivr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#srotsyjivr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#srotsyjivr .gt_spanner_row {
  border-bottom-style: hidden;
}

#srotsyjivr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#srotsyjivr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#srotsyjivr .gt_from_md > :first-child {
  margin-top: 0;
}

#srotsyjivr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#srotsyjivr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#srotsyjivr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#srotsyjivr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#srotsyjivr .gt_row_group_first td {
  border-top-width: 2px;
}

#srotsyjivr .gt_row_group_first th {
  border-top-width: 2px;
}

#srotsyjivr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#srotsyjivr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#srotsyjivr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#srotsyjivr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#srotsyjivr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#srotsyjivr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#srotsyjivr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#srotsyjivr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#srotsyjivr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#srotsyjivr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#srotsyjivr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#srotsyjivr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#srotsyjivr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#srotsyjivr .gt_left {
  text-align: left;
}

#srotsyjivr .gt_center {
  text-align: center;
}

#srotsyjivr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#srotsyjivr .gt_font_normal {
  font-weight: normal;
}

#srotsyjivr .gt_font_bold {
  font-weight: bold;
}

#srotsyjivr .gt_font_italic {
  font-style: italic;
}

#srotsyjivr .gt_super {
  font-size: 65%;
}

#srotsyjivr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#srotsyjivr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#srotsyjivr .gt_indent_1 {
  text-indent: 5px;
}

#srotsyjivr .gt_indent_2 {
  text-indent: 10px;
}

#srotsyjivr .gt_indent_3 {
  text-indent: 15px;
}

#srotsyjivr .gt_indent_4 {
  text-indent: 20px;
}

#srotsyjivr .gt_indent_5 {
  text-indent: 25px;
}
</style>
<div style="font-family:system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;border-top-style:solid;border-top-width:2px;border-top-color:#D3D3D3;">
<div class="gt_heading gt_title gt_font_normal" style="text-size:bigger;"><strong>Statistiques de frÃ©quentation</strong></div>
<div class="gt_heading gt_subtitle ">Classement des aÃ©roports</div>
</div>
<div id="srotsyjivr" class="reactable html-widget" style="width:auto;height:auto;"></div>
<div style="font-family:system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;border-top-style:solid;border-top-width:2px;border-top-color:#D3D3D3;border-bottom-style:solid;border-bottom-width:2px;border-bottom-color:#D3D3D3;padding-top:6px;padding-bottom:6px;padding-left:10px;padding-right:10px;">
<div>


<em>Source: DGAC, Ã  partir des donnÃ©es sur data.gouv.fr</em>


</div>
<div></div>
</div>
<script type="application/json" data-for="srotsyjivr">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"name_clean":["Paris-charles de gaulle _(LFPG)_","Paris-orly _(LFPO)_","Nice-cote d'azur _(LFMN)_","Lyon-st-exupery _(LFLL)_","Toulouse-blagnac _(LFBO)_","Marseille-provence _(LFML)_","Bale-mulhouse _(LFSB)_","Bordeaux-merignac _(LFBD)_","Nantes-atlantique _(LFRS)_","Beauvais-tille _(LFOB)_","La reunion-roland garros _(FMEE)_","Pointe-a-pitre-le raizet _(TFFR)_","Martinique-aime cesaire _(TFFF)_","Montpellier-mediterranee _(LFMT)_","Lille-lesquin _(LFQQ)_","Tahiti faa'a _(NTAA)_","Strasbourg-entzheim _(LFST)_","Brest-bretagne _(LFRB)_","Grenoble-alpes-isere _(LFLS)_","Biarritz-pays-basque _(LFBZ)_","Ajaccio-napoleon-bonaparte _(LFKJ)_","Noumea la tontouta _(NWWW)_","Bastia-poretta _(LFKB)_","Chambery-aix-les-bains _(LFLB)_","Rennes-st-jacques _(LFRN)_","Pau-pyrenees _(LFBP)_","Cayenne-felix eboue _(SOCA)_","Noumea magenta _(NWWM)_","Clermont-ferrand-auvergne _(LFLC)_","Toulon-hyeres _(LFTH)_","Perpignan-rivesaltes _(LFMP)_","Mayotte-marcel henry _(FMCZ)_","Carcassonne-salvaza _(LFMK)_","Bora bora _(NTTB)_","Lifou _(NWWL)_","Raiatea _(NTTR)_","Limoges-bellegarde _(LFBL)_","Nimes-garons _(LFTW)_","Autres apt (om) _(ZZOM)_","Figari-sud-corse _(LFKF)_","Tarbes-lourdes-pyrenees _(LFBT)_","St-martin-grand-case _(TFFG)_","St-pierre-pierrefonds _(FMEP)_","St-barthelemy _(TFFJ)_","Metz-nancy-lorraine _(LFJL)_","Caen-carpiquet _(LFRK)_","Ile des pins _(NWWE)_","Tours-val de loire _(LFOT)_","Lorient-lann-bihoue _(LFRH)_","Paris-le bourget _(LFPB)_","Ouvea _(NWWV)_","Mare _(NWWR)_","Autres apt (mt) _(ZZMT)_","Calvi-ste-catherine _(LFKC)_","Huahine _(NTTH)_","Dole-tavaux _(LFGJ)_","Bergerac-dordogne-perigord _(LFBE)_","Beziers-vias _(LFMU)_","Dinard-pleurtuit-st-malo _(LFRD)_","Rangiroa _(NTTG)_","Rodez-aveyron _(LFCR)_","Quimper-pluguffan _(LFRQ)_","Poitiers-biard _(LFBI)_","La rochelle-ile de re _(LFBH)_","Wallis-hihifo _(NLWW)_","Chalons-vatry _(LFOK)_","Brive-souillac _(LFSL)_","Moorea _(NTTM)_","Castres-mazamet _(LFCK)_","Nuku hiva _(NTMD)_","Maripasoula _(SOOA)_","Aurillac _(LFLW)_","Agen-la garenne _(LFBA)_","Deauville-normandie _(LFRG)_","Hiva oa-atuona _(NTMN)_","St-pierre-pointe blanche _(LFVP)_","Maupiti _(NTTP)_","Tubuai mataura _(NTAT)_","Tikehau _(NTGC)_","Fakarava _(NTGF)_","Rurutu _(NTAR)_","Courchevel _(LFLJ)_","St-nazaire-montoir _(LFRZ)_","Futuna _(NLWF)_","Raivavae _(NTAV)_","Hao _(NTTO)_","Chateauroux-deols _(LFLX)_","Albert-bray _(LFAQ)_"],"paxdep":[2597751,1161426,367646,355363,340036,293834,222750,195048,170975,128104,112430,111998,91004,63071,54976,43348,39338,38435,35543,34386,30024,29353,29165,26015,24407,24068,19266,18437,15513,15004,13408,13108,10148,9986,8498,7813,7493,7114,6791,6606,6135,6089,6034,5949,5569,5459,5185,5138,4837,4416,4051,3971,3910,3881,3842,3685,3476,3066,2566,2379,2375,2366,2327,2245,2142,2109,2081,1859,1841,1768,1404,1389,1335,1270,1232,1102,1098,1062,1056,1024,1021,596,586,516,493,381,166,119],"paxarr":[2615400,1222901,363372,369899,337295,304546,241617,190208,166728,136452,127167,126329,99705,63662,56499,55449,40479,34913,37206,30939,28119,28587,27115,25320,23858,22375,22073,20461,14817,13973,12783,18977,10011,8632,7489,6972,6798,7021,4781,5597,5610,7609,7181,5160,6060,5241,4635,4927,4083,4603,3955,3573,3445,3260,2943,3954,2924,2995,2137,2055,2051,1848,2225,2125,2123,2269,1788,1092,1497,1548,1247,1209,1178,1275,1030,1031,685,711,789,720,536,804,578,472,222,430,166,124],"paxtra":[2938,54,733,4586,3594,5151,7,4044,2078,83,4768,5137,6007,88,1027,885,137,1848,172,0,0,0,0,11,557,162,1825,0,673,0,0,1202,0,1730,0,3145,24,0,4681,0,0,124,0,0,308,13,0,0,0,0,0,0,70,0,3063,0,0,0,0,1202,0,0,1628,0,0,2,0,1156,0,497,431,0,0,837,488,0,5,535,1192,272,568,0,153,0,277,663,0,0]},"columns":[{"id":"name_clean","name":"<strong>AÃ©roport<\/strong>","type":"character","style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["<div data-qmd=\"Paris-charles de gaulle _(LFPG)_\"><div class='gt_from_md'><p>Paris-charles de gaulle <em>(LFPG)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Paris-orly _(LFPO)_\"><div class='gt_from_md'><p>Paris-orly <em>(LFPO)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Nice-cote d'azur _(LFMN)_\"><div class='gt_from_md'><p>Nice-cote dâ€™azur <em>(LFMN)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Lyon-st-exupery _(LFLL)_\"><div class='gt_from_md'><p>Lyon-st-exupery <em>(LFLL)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Toulouse-blagnac _(LFBO)_\"><div class='gt_from_md'><p>Toulouse-blagnac <em>(LFBO)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Marseille-provence _(LFML)_\"><div class='gt_from_md'><p>Marseille-provence <em>(LFML)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Bale-mulhouse _(LFSB)_\"><div class='gt_from_md'><p>Bale-mulhouse <em>(LFSB)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Bordeaux-merignac _(LFBD)_\"><div class='gt_from_md'><p>Bordeaux-merignac <em>(LFBD)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Nantes-atlantique _(LFRS)_\"><div class='gt_from_md'><p>Nantes-atlantique <em>(LFRS)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Beauvais-tille _(LFOB)_\"><div class='gt_from_md'><p>Beauvais-tille <em>(LFOB)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"La reunion-roland garros _(FMEE)_\"><div class='gt_from_md'><p>La reunion-roland garros <em>(FMEE)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Pointe-a-pitre-le raizet _(TFFR)_\"><div class='gt_from_md'><p>Pointe-a-pitre-le raizet <em>(TFFR)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Martinique-aime cesaire _(TFFF)_\"><div class='gt_from_md'><p>Martinique-aime cesaire <em>(TFFF)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Montpellier-mediterranee _(LFMT)_\"><div class='gt_from_md'><p>Montpellier-mediterranee <em>(LFMT)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Lille-lesquin _(LFQQ)_\"><div class='gt_from_md'><p>Lille-lesquin <em>(LFQQ)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Tahiti faa'a _(NTAA)_\"><div class='gt_from_md'><p>Tahiti faaâ€™a <em>(NTAA)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Strasbourg-entzheim _(LFST)_\"><div class='gt_from_md'><p>Strasbourg-entzheim <em>(LFST)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Brest-bretagne _(LFRB)_\"><div class='gt_from_md'><p>Brest-bretagne <em>(LFRB)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Grenoble-alpes-isere _(LFLS)_\"><div class='gt_from_md'><p>Grenoble-alpes-isere <em>(LFLS)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Biarritz-pays-basque _(LFBZ)_\"><div class='gt_from_md'><p>Biarritz-pays-basque <em>(LFBZ)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Ajaccio-napoleon-bonaparte _(LFKJ)_\"><div class='gt_from_md'><p>Ajaccio-napoleon-bonaparte <em>(LFKJ)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Noumea la tontouta _(NWWW)_\"><div class='gt_from_md'><p>Noumea la tontouta <em>(NWWW)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Bastia-poretta _(LFKB)_\"><div class='gt_from_md'><p>Bastia-poretta <em>(LFKB)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Chambery-aix-les-bains _(LFLB)_\"><div class='gt_from_md'><p>Chambery-aix-les-bains <em>(LFLB)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Rennes-st-jacques _(LFRN)_\"><div class='gt_from_md'><p>Rennes-st-jacques <em>(LFRN)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Pau-pyrenees _(LFBP)_\"><div class='gt_from_md'><p>Pau-pyrenees <em>(LFBP)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Cayenne-felix eboue _(SOCA)_\"><div class='gt_from_md'><p>Cayenne-felix eboue <em>(SOCA)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Noumea magenta _(NWWM)_\"><div class='gt_from_md'><p>Noumea magenta <em>(NWWM)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Clermont-ferrand-auvergne _(LFLC)_\"><div class='gt_from_md'><p>Clermont-ferrand-auvergne <em>(LFLC)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Toulon-hyeres _(LFTH)_\"><div class='gt_from_md'><p>Toulon-hyeres <em>(LFTH)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Perpignan-rivesaltes _(LFMP)_\"><div class='gt_from_md'><p>Perpignan-rivesaltes <em>(LFMP)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Mayotte-marcel henry _(FMCZ)_\"><div class='gt_from_md'><p>Mayotte-marcel henry <em>(FMCZ)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Carcassonne-salvaza _(LFMK)_\"><div class='gt_from_md'><p>Carcassonne-salvaza <em>(LFMK)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Bora bora _(NTTB)_\"><div class='gt_from_md'><p>Bora bora <em>(NTTB)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Lifou _(NWWL)_\"><div class='gt_from_md'><p>Lifou <em>(NWWL)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Raiatea _(NTTR)_\"><div class='gt_from_md'><p>Raiatea <em>(NTTR)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Limoges-bellegarde _(LFBL)_\"><div class='gt_from_md'><p>Limoges-bellegarde <em>(LFBL)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Nimes-garons _(LFTW)_\"><div class='gt_from_md'><p>Nimes-garons <em>(LFTW)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Autres apt (om) _(ZZOM)_\"><div class='gt_from_md'><p>Autres apt (om) <em>(ZZOM)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Figari-sud-corse _(LFKF)_\"><div class='gt_from_md'><p>Figari-sud-corse <em>(LFKF)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Tarbes-lourdes-pyrenees _(LFBT)_\"><div class='gt_from_md'><p>Tarbes-lourdes-pyrenees <em>(LFBT)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"St-martin-grand-case _(TFFG)_\"><div class='gt_from_md'><p>St-martin-grand-case <em>(TFFG)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"St-pierre-pierrefonds _(FMEP)_\"><div class='gt_from_md'><p>St-pierre-pierrefonds <em>(FMEP)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"St-barthelemy _(TFFJ)_\"><div class='gt_from_md'><p>St-barthelemy <em>(TFFJ)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Metz-nancy-lorraine _(LFJL)_\"><div class='gt_from_md'><p>Metz-nancy-lorraine <em>(LFJL)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Caen-carpiquet _(LFRK)_\"><div class='gt_from_md'><p>Caen-carpiquet <em>(LFRK)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Ile des pins _(NWWE)_\"><div class='gt_from_md'><p>Ile des pins <em>(NWWE)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Tours-val de loire _(LFOT)_\"><div class='gt_from_md'><p>Tours-val de loire <em>(LFOT)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Lorient-lann-bihoue _(LFRH)_\"><div class='gt_from_md'><p>Lorient-lann-bihoue <em>(LFRH)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Paris-le bourget _(LFPB)_\"><div class='gt_from_md'><p>Paris-le bourget <em>(LFPB)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Ouvea _(NWWV)_\"><div class='gt_from_md'><p>Ouvea <em>(NWWV)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Mare _(NWWR)_\"><div class='gt_from_md'><p>Mare <em>(NWWR)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Autres apt (mt) _(ZZMT)_\"><div class='gt_from_md'><p>Autres apt (mt) <em>(ZZMT)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Calvi-ste-catherine _(LFKC)_\"><div class='gt_from_md'><p>Calvi-ste-catherine <em>(LFKC)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Huahine _(NTTH)_\"><div class='gt_from_md'><p>Huahine <em>(NTTH)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Dole-tavaux _(LFGJ)_\"><div class='gt_from_md'><p>Dole-tavaux <em>(LFGJ)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Bergerac-dordogne-perigord _(LFBE)_\"><div class='gt_from_md'><p>Bergerac-dordogne-perigord <em>(LFBE)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Beziers-vias _(LFMU)_\"><div class='gt_from_md'><p>Beziers-vias <em>(LFMU)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Dinard-pleurtuit-st-malo _(LFRD)_\"><div class='gt_from_md'><p>Dinard-pleurtuit-st-malo <em>(LFRD)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Rangiroa _(NTTG)_\"><div class='gt_from_md'><p>Rangiroa <em>(NTTG)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Rodez-aveyron _(LFCR)_\"><div class='gt_from_md'><p>Rodez-aveyron <em>(LFCR)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Quimper-pluguffan _(LFRQ)_\"><div class='gt_from_md'><p>Quimper-pluguffan <em>(LFRQ)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Poitiers-biard _(LFBI)_\"><div class='gt_from_md'><p>Poitiers-biard <em>(LFBI)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"La rochelle-ile de re _(LFBH)_\"><div class='gt_from_md'><p>La rochelle-ile de re <em>(LFBH)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Wallis-hihifo _(NLWW)_\"><div class='gt_from_md'><p>Wallis-hihifo <em>(NLWW)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Chalons-vatry _(LFOK)_\"><div class='gt_from_md'><p>Chalons-vatry <em>(LFOK)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Brive-souillac _(LFSL)_\"><div class='gt_from_md'><p>Brive-souillac <em>(LFSL)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Moorea _(NTTM)_\"><div class='gt_from_md'><p>Moorea <em>(NTTM)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Castres-mazamet _(LFCK)_\"><div class='gt_from_md'><p>Castres-mazamet <em>(LFCK)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Nuku hiva _(NTMD)_\"><div class='gt_from_md'><p>Nuku hiva <em>(NTMD)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Maripasoula _(SOOA)_\"><div class='gt_from_md'><p>Maripasoula <em>(SOOA)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Aurillac _(LFLW)_\"><div class='gt_from_md'><p>Aurillac <em>(LFLW)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Agen-la garenne _(LFBA)_\"><div class='gt_from_md'><p>Agen-la garenne <em>(LFBA)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Deauville-normandie _(LFRG)_\"><div class='gt_from_md'><p>Deauville-normandie <em>(LFRG)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Hiva oa-atuona _(NTMN)_\"><div class='gt_from_md'><p>Hiva oa-atuona <em>(NTMN)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"St-pierre-pointe blanche _(LFVP)_\"><div class='gt_from_md'><p>St-pierre-pointe blanche <em>(LFVP)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Maupiti _(NTTP)_\"><div class='gt_from_md'><p>Maupiti <em>(NTTP)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Tubuai mataura _(NTAT)_\"><div class='gt_from_md'><p>Tubuai mataura <em>(NTAT)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Tikehau _(NTGC)_\"><div class='gt_from_md'><p>Tikehau <em>(NTGC)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Fakarava _(NTGF)_\"><div class='gt_from_md'><p>Fakarava <em>(NTGF)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Rurutu _(NTAR)_\"><div class='gt_from_md'><p>Rurutu <em>(NTAR)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Courchevel _(LFLJ)_\"><div class='gt_from_md'><p>Courchevel <em>(LFLJ)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"St-nazaire-montoir _(LFRZ)_\"><div class='gt_from_md'><p>St-nazaire-montoir <em>(LFRZ)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Futuna _(NLWF)_\"><div class='gt_from_md'><p>Futuna <em>(NLWF)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Raivavae _(NTAV)_\"><div class='gt_from_md'><p>Raivavae <em>(NTAV)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Hao _(NTTO)_\"><div class='gt_from_md'><p>Hao <em>(NTTO)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Chateauroux-deols _(LFLX)_\"><div class='gt_from_md'><p>Chateauroux-deols <em>(LFLX)<\/em><\/p>\n<\/div><\/div>","<div data-qmd=\"Albert-bray _(LFAQ)_\"><div class='gt_from_md'><p>Albert-bray <em>(LFAQ)<\/em><\/p>\n<\/div><\/div>"],"html":true,"align":"left","headerStyle":{"font-weight":"normal"}},{"id":"paxdep","name":"<strong>DÃ©parts<\/strong>","type":"numeric","style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["2.60M","1.16M","367.65K","355.36K","340.04K","293.83K","222.75K","195.05K","170.97K","128.10K","112.43K","112.00K","91.00K","63.07K","54.98K","43.35K","39.34K","38.44K","35.54K","34.39K","30.02K","29.35K","29.16K","26.02K","24.41K","24.07K","19.27K","18.44K","15.51K","15.00K","13.41K","13.11K","10.15K","9.99K","8.50K","7.81K","7.49K","7.11K","6.79K","6.61K","6.13K","6.09K","6.03K","5.95K","5.57K","5.46K","5.19K","5.14K","4.84K","4.42K","4.05K","3.97K","3.91K","3.88K","3.84K","3.69K","3.48K","3.07K","2.57K","2.38K","2.38K","2.37K","2.33K","2.25K","2.14K","2.11K","2.08K","1.86K","1.84K","1.77K","1.40K","1.39K","1.33K","1.27K","1.23K","1.10K","1.10K","1.06K","1.06K","1.02K","1.02K","596.00","586.00","516.00","493.00","381.00","166.00","119.00"],"html":true,"align":"right","headerStyle":{"font-weight":"normal"}},{"id":"paxarr","name":"<strong>ArrivÃ©e<\/strong>","type":"numeric","style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["2.62M","1.22M","363.37K","369.90K","337.30K","304.55K","241.62K","190.21K","166.73K","136.45K","127.17K","126.33K","99.70K","63.66K","56.50K","55.45K","40.48K","34.91K","37.21K","30.94K","28.12K","28.59K","27.12K","25.32K","23.86K","22.38K","22.07K","20.46K","14.82K","13.97K","12.78K","18.98K","10.01K","8.63K","7.49K","6.97K","6.80K","7.02K","4.78K","5.60K","5.61K","7.61K","7.18K","5.16K","6.06K","5.24K","4.63K","4.93K","4.08K","4.60K","3.96K","3.57K","3.45K","3.26K","2.94K","3.95K","2.92K","3.00K","2.14K","2.06K","2.05K","1.85K","2.23K","2.12K","2.12K","2.27K","1.79K","1.09K","1.50K","1.55K","1.25K","1.21K","1.18K","1.28K","1.03K","1.03K","685.00","711.00","789.00","720.00","536.00","804.00","578.00","472.00","222.00","430.00","166.00","124.00"],"html":true,"align":"right","headerStyle":{"font-weight":"normal"}},{"id":"paxtra","name":"<strong>Transit<\/strong>","type":"numeric","style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["2.94K","54.00","733.00","4.59K","3.59K","5.15K","7.00","4.04K","2.08K","83.00","4.77K","5.14K","6.01K","88.00","1.03K","885.00","137.00","1.85K","172.00","0.00","0.00","0.00","0.00","11.00","557.00","162.00","1.82K","0.00","673.00","0.00","0.00","1.20K","0.00","1.73K","0.00","3.15K","24.00","0.00","4.68K","0.00","0.00","124.00","0.00","0.00","308.00","13.00","0.00","0.00","0.00","0.00","0.00","0.00","70.00","0.00","3.06K","0.00","0.00","0.00","0.00","1.20K","0.00","0.00","1.63K","0.00","0.00","2.00","0.00","1.16K","0.00","497.00","431.00","0.00","0.00","837.00","488.00","0.00","5.00","535.00","1.19K","272.00","568.00","0.00","153.00","0.00","277.00","663.00","0.00","0.00"],"html":true,"align":"right","headerStyle":{"font-weight":"normal"}}],"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"showSortable":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"rgba(128,128,128,0.05)","style":{"fontFamily":"system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif"},"headerStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"}},"elementId":"srotsyjivr","dataKey":"311275f30a10f35b729f971f7eabd324"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
<p>Nous proposons de transformer ce code en fonction, cela facilitera lâ€™utilisation ultÃ©rieure de celui-ci dans notre application.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<i class="bi bi-book"></i> Exercice 4c (optionnel): transformer en fonction notre chaÃ®ne <code>gt</code>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Cet exercice est optionnel. Transformer le code ci-dessus en fonction. Mettre Ã  jour <code>main.R</code> pour utiliser ceci dans votre application.</p>
</div>
</div>
</div>
<details>
<summary>
Code de <code>R/tables.R</code>
</summary>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R/tables.R</strong></pre>
</div>
<div class="sourceCode" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>create_table_airports <span class="ot">&lt;-</span> <span class="cf">function</span>(stats_aeroports){</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  stats_aeroports_table <span class="ot">&lt;-</span> stats_aeroports <span class="sc">%&gt;%</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">name_clean =</span> <span class="fu">paste0</span>(<span class="fu">str_to_sentence</span>(apt_nom), <span class="st">" _("</span>, apt, <span class="st">")_"</span>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(name_clean, <span class="fu">everything</span>())</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  table_aeroports <span class="ot">&lt;-</span> <span class="fu">gt</span>(stats_aeroports_table)</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  table_aeroports <span class="ot">&lt;-</span> table_aeroports <span class="sc">%&gt;%</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cols_hide</span>(<span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"apt"</span>))</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  table_aeroports <span class="ot">&lt;-</span> table_aeroports <span class="sc">%&gt;%</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"pax"</span>), <span class="at">suffixing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  table_aeroports <span class="ot">&lt;-</span> table_aeroports <span class="sc">%&gt;%</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fmt_markdown</span>(<span class="at">columns =</span> <span class="st">"name_clean"</span>)</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  table_aeroports <span class="ot">&lt;-</span> table_aeroports <span class="sc">%&gt;%</span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cols_label</span>(</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">name_clean =</span> <span class="fu">md</span>(<span class="st">"**AÃ©roport**"</span>),</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">paxdep =</span> <span class="fu">md</span>(<span class="st">"**DÃ©parts**"</span>),</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">paxarr =</span> <span class="fu">md</span>(<span class="st">"**ArrivÃ©e**"</span>),</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">paxtra =</span> <span class="fu">md</span>(<span class="st">"**Transit**"</span>)</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_header</span>(</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">md</span>(<span class="st">"**Statistiques de frÃ©quentation**"</span>),</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="fu">md</span>(<span class="st">"Classement des aÃ©roports"</span>)</span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_style</span>(</span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"powderblue"</span>),</span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">locations =</span> <span class="fu">cells_title</span>()</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_source_note</span>(<span class="at">source_note =</span> <span class="fu">md</span>(<span class="st">"_Source: DGAC, Ã  partir des donnÃ©es sur data.gouv.fr_"</span>))</span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>  table_aeroports <span class="ot">&lt;-</span> table_aeroports <span class="sc">%&gt;%</span></span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">opt_interactive</span>()</span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(table_aeroports)</span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<details>
<summary>
Code de <code>main.R</code>
</summary>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>main.R</strong></pre>
</div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/import_data.R"</span>)</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/create_data_list.R"</span>)</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/clean_dataframe.R"</span>)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/divers_functions.R"</span>)</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/tables.R"</span>)</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/figures.R"</span>)</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>YEARS_LIST  <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="dv">2018</span><span class="sc">:</span><span class="dv">2022</span>)</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>MONTHS_LIST <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">"0"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>), <span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>)</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>year <span class="ot">&lt;-</span> YEARS_LIST[<span class="dv">1</span>]</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>month <span class="ot">&lt;-</span> MONTHS_LIST[<span class="dv">1</span>]</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data ----------------------------------</span></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>urls <span class="ot">&lt;-</span> <span class="fu">create_data_list</span>(<span class="st">"./sources.yml"</span>)</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>pax_apt_all <span class="ot">&lt;-</span> <span class="fu">import_airport_data</span>(<span class="fu">unlist</span>(urls<span class="sc">$</span>airports))</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>pax_cie_all <span class="ot">&lt;-</span> <span class="fu">import_compagnies_data</span>(<span class="fu">unlist</span>(urls<span class="sc">$</span>compagnies))</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>pax_lsn_all <span class="ot">&lt;-</span> <span class="fu">import_liaisons_data</span>(<span class="fu">unlist</span>(urls<span class="sc">$</span>liaisons))</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>airports_location <span class="ot">&lt;-</span> <span class="fu">st_read</span>(urls<span class="sc">$</span>geojson<span class="sc">$</span>airport)</span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>liste_aeroports <span class="ot">&lt;-</span> <span class="fu">unique</span>(pax_apt_all<span class="sc">$</span>apt)</span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>default_airport <span class="ot">&lt;-</span> liste_aeroports[<span class="dv">1</span>]</span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a><span class="co"># OBJETS NECESSAIRES A L'APPLICATION ------------------------</span></span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a>trafic_aeroports <span class="ot">&lt;-</span> pax_apt_all <span class="sc">%&gt;%</span></span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trafic =</span> apt_pax_dep <span class="sc">+</span> apt_pax_tr <span class="sc">+</span> apt_pax_arr) <span class="sc">%&gt;%</span></span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(apt <span class="sc">%in%</span> default_airport) <span class="sc">%&gt;%</span></span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(anmois, <span class="st">"01"</span>, <span class="at">sep=</span><span class="st">""</span>), <span class="at">format =</span> <span class="st">"%Y%m%d"</span>)</span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a>stats_aeroports <span class="ot">&lt;-</span> <span class="fu">summary_stat_airport</span>(</span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">create_data_from_input</span>(pax_apt_all, year, month)</span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a>stats_liaisons  <span class="ot">&lt;-</span> <span class="fu">summary_stat_liaisons</span>(</span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">create_data_from_input</span>(pax_lsn_all, year, month)</span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-51"><a href="#cb47-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-52"><a href="#cb47-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-53"><a href="#cb47-53" aria-hidden="true" tabindex="-1"></a><span class="co"># VALORISATIONS ----------------------------------------------</span></span>
<span id="cb47-54"><a href="#cb47-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-55"><a href="#cb47-55" aria-hidden="true" tabindex="-1"></a>figure_plotly <span class="ot">&lt;-</span> <span class="fu">plot_airport_line</span>(trafic_aeroports,default_airport)</span>
<span id="cb47-56"><a href="#cb47-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-57"><a href="#cb47-57" aria-hidden="true" tabindex="-1"></a>table_airports <span class="ot">&lt;-</span> <span class="fu">create_table_airports</span>(stats_aeroports)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
</section>
<section id="carte-des-aÃ©roports" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="carte-des-aÃ©roports"><span class="header-section-number">4.3</span> Carte des aÃ©roports</h2>
<p>La derniÃ¨re valorisation que nous allons intÃ©grer est une carte interactive du trafic de nos aÃ©roports. Cette carte va Ãªtre assez basique. Si vous dÃ©sirez mettre en oeuvre des visualisations plus complexes, vous pouvez tout Ã  fait le faire.</p>
<p>Pour cet exercice, nous allons fixer une date pour prototyper notre code. Cela nous facilitera la transformation ultÃ©rieure en fonction.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>months <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="dv">2019</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Voici Ã©galement une palette de couleurs qui sera utile Ã  la fin de lâ€™exercice.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>palette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<i class="bi bi-book"></i> Exercice 5: carte aÃ©rienne du trafic aÃ©roportuaire
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ol type="1">
<li>CrÃ©er un <em>dataframe</em> <code>trafic_date</code> en ne conservant que les observations de <code>pax_apt_all</code> Ã©gales Ã  un certain mois et annÃ©e (vous pouvez vous inspirer dâ€™un <code>filter</code> fait prÃ©cÃ©demment). Utiliser celui-ci en faisant une jointure avec <code>airports_location</code> par le biais des variables, respectivement, <code>Code.OACI</code> et <code>apt</code>. Nommer ce <em>dataframe</em> <code>trafic_aeroports</code></li>
<li>A partir de lâ€™<a href="https://rstudio.github.io/leaflet/articles/markers.html">exemple de dÃ©marrage de <code>leaflet</code></a>, crÃ©er une carte interactive qui affiche, lorsquâ€™on clique sur lâ€™un des marqueurs, le nom de lâ€™aÃ©roport et sa frÃ©quentation.</li>
<li>CrÃ©er une variable nommÃ©e <code>volume</code> qui classe chaque observation dans son <a href="https://fr.wiktionary.org/wiki/tercile">tercile</a> et transforme la valeur en couleur Ã  partir de <code>palette</code>.<br>
</li>
<li>A partir du code suivant et de la <a href="https://rstudio.github.io/leaflet/articles/markers.html#awesome-icons">fonction <code>addAwesomeMarkers</code></a>, reproduire une carte similaire Ã  celle prÃ©sentÃ©e plus bas.</li>
</ol>
<div class="sourceCode" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>icons <span class="ot">&lt;-</span> <span class="fu">awesomeIcons</span>(</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">icon =</span> <span class="st">'plane'</span>,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">iconColor =</span> <span class="st">'black'</span>,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">library =</span> <span class="st">'fa'</span>,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">markerColor =</span> trafic_aeroports<span class="sc">$</span>color</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
SubtilitÃ© par rapport Ã  lâ€™exemple de <a href="https://rstudio.github.io/leaflet/articles/markers.html#awesome-icons">la documentation</a>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Par rapport Ã  lâ€™exemple dans <a href="https://rstudio.github.io/leaflet/articles/markers.html#awesome-icons">la documentation</a>, il faut lÃ©gÃ¨rement modifier le code de sorte Ã  faire <code>icon=icons[]</code> et non <code>icon = icons</code>.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Question 1</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>trafic_date <span class="ot">&lt;-</span> pax_apt_all <span class="sc">%&gt;%</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(anmois, <span class="st">"01"</span>, <span class="at">sep=</span><span class="st">""</span>), <span class="at">format =</span> <span class="st">"%Y%m%d"</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mois <span class="sc">%in%</span> months, an <span class="sc">%in%</span> years)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>trafic_aeroports <span class="ot">&lt;-</span> airports_location <span class="sc">%&gt;%</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(trafic_date, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Code.OACI"</span> <span class="ot">=</span> <span class="st">"apt"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Question 2</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>(trafic_aeroports) <span class="sc">%&gt;%</span> <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addMarkers</span>(<span class="at">popup =</span> <span class="sc">~</span><span class="fu">paste0</span>(Nom, <span class="st">": "</span>, trafic)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Question 3</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>trafic_aeroports <span class="ot">&lt;-</span> trafic_aeroports <span class="sc">%&gt;%</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">volume =</span> <span class="fu">ntile</span>(trafic, <span class="dv">3</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> palette[volume]</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Question 3</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>icons <span class="ot">&lt;-</span> <span class="fu">awesomeIcons</span>(</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">icon =</span> <span class="st">'plane'</span>,</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">iconColor =</span> <span class="st">'black'</span>,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">library =</span> <span class="st">'fa'</span>,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">markerColor =</span> trafic_aeroports<span class="sc">$</span>color</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>carte_interactive <span class="ot">&lt;-</span> <span class="fu">leaflet</span>(trafic_aeroports) <span class="sc">%&gt;%</span> <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addAwesomeMarkers</span>(</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">icon=</span>icons[],</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">label=</span><span class="sc">~</span><span class="fu">paste0</span>(Nom, <span class="st">""</span>, <span class="st">" ("</span>,Code.OACI, <span class="st">") : "</span>, trafic, <span class="st">" voyageurs"</span>)</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>carte_interactive</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-b3e7c0908adbdf9cabe6" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-b3e7c0908adbdf9cabe6">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addAwesomeMarkers","args":[[-23.37,-22.59,-22.43,-22.26,-22.01,-21.48,-20.89,-20.77,-20.64,-17.55,-17.49,-16.72,-16.69,-16.44,-16.43,-16.05,-15.12,-14.95,-12.81,-9.77,-8.800000000000001,3.66,4.82,14.59,16.27,17.9,18.1,41.5,41.92,42.52,42.55,42.74,43.1,43.19,43.32,43.38,43.44,43.47,43.56,43.58,43.64,43.67,44.83,44.9,45.04,45.73,45.79,46.76,47.04,47.16,47.31,47.43,47.59,48.07,48.45,48.54,48.72,48.77,48.97,49.01,49.17,49.45,50.56],[-149.52,167.46,-151.36,166.47,166.21,168.04,55.51,167.24,166.57,-149.61,-149.76,-151.47,-151.02,-151.75,-152.24,-145.66,-148.23,-147.66,45.28,-139.01,-140.23,-54.04,-52.36,-61,-61.53,-62.84,-63.05,9.1,8.800000000000001,8.789999999999999,9.48,2.87,6.15,0.01,3.35,-0.42,5.22,-1.53,2.29,3.96,1.37,7.22,-0.72,2.42,1.49,5.08,3.16,-56.17,5.44,-1.61,-2.16,0.72,7.53,-1.73,-4.42,7.63,2.38,4.21,2.44,2.55,-0.45,2.11,3.09],{"icon":"plane","markerColor":["green","blue","green","red","green","blue","blue","blue","blue","red","green","blue","blue","blue","green","green","green","green","blue","green","green","green","blue","red","red","blue","blue","red","red","blue","red","blue","blue","green","green","blue","red","red","green","red","red","red","red","green","green","red","blue","green","green","red","green","green","red","blue","red","blue","red","green","blue","red","blue","red","red"],"iconColor":"black","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"fa"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,["TUBUAI MATAURA (NTAT) : 1667 voyageurs","ILE DES PINS (NWWE) : 6986 voyageurs","RURUTU (NTAR) : 1565 voyageurs","NOUMEA MAGENTA (NWWM) : 33611 voyageurs","NOUMEA LA TONTOUTA (NWWW) : 2523 voyageurs","MARE (NWWR) : 7199 voyageurs","LA REUNION-ROLAND GARROS (FMEE) : 26638 voyageurs","LIFOU (NWWL) : 14180 voyageurs","OUVEA (NWWV) : 6076 voyageurs","TAHITI FAA'A (NTAA) : 48915 voyageurs","MOOREA (NTTM) : 1324 voyageurs","RAIATEA (NTTR) : 15164 voyageurs","HUAHINE (NTTH) : 8570 voyageurs","BORA BORA (NTTB) : 11853 voyageurs","MAUPITI (NTTP) : 1636 voyageurs","FAKARAVA (NTGF) : 1812 voyageurs","TIKEHAU (NTGC) : 2472 voyageurs","RANGIROA (NTTG) : 4737 voyageurs","MAYOTTE-DZAOUDZI-PAMANDZI (FMCZ) : 9618 voyageurs","HIVA OA-ATUONA (NTMN) : 2386 voyageurs","NUKU HIVA (NTMD) : 2575 voyageurs","MARIPASOULA (SOOA) : 2333 voyageurs","CAYENNE-FELIX EBOUE (SOCA) : 12828 voyageurs","MARTINIQUE-AIME CESAIRE (TFFF) : 36952 voyageurs","POINTE-A-PITRE-LE RAIZET (TFFR) : 48447 voyageurs","ST-BARTHELEMY (TFFJ) : 10133 voyageurs","ST-MARTIN-GRAND-CASE (TFFG) : 7938 voyageurs","FIGARI-SUD-CORSE (LFKF) : 59538 voyageurs","AJACCIO-NAPOLEON-BONAPARTE (LFKJ) : 106167 voyageurs","CALVI-STE-CATHERINE (LFKC) : 16073 voyageurs","BASTIA-PORETTA (LFKB) : 82308 voyageurs","PERPIGNAN-RIVESALTES (LFMP) : 14174 voyageurs","TOULON-HYERES (LFTH) : 23233 voyageurs","TARBES-LOURDES-PYRENEES (LFBT) : 3233 voyageurs","BEZIERS-VIAS (LFMU) : 2632 voyageurs","PAU-PYRENEES (LFBP) : 15378 voyageurs","MARSEILLE-PROVENCE (LFML) : 223497 voyageurs","BIARRITZ-PAYS-BASQUE (LFBZ) : 29732 voyageurs","CASTRES-MAZAMET (LFCK) : 2209 voyageurs","MONTPELLIER-MEDITERRANEE (LFMT) : 52974 voyageurs","TOULOUSE-BLAGNAC (LFBO) : 168654 voyageurs","NICE-COTE D'AZUR (LFMN) : 323878 voyageurs","BORDEAUX-MERIGNAC (LFBD) : 123750 voyageurs","AURILLAC (LFLW) : 1725 voyageurs","BRIVE-SOUILLAC (LFSL) : 1553 voyageurs","LYON-ST-EXUPERY (LFLL) : 189096 voyageurs","CLERMONT-FERRAND-AUVERGNE (LFLC) : 4757 voyageurs","ST-PIERRE-POINTE BLANCHE (LFVP) : 1214 voyageurs","DOLE-TAVAUX (LFGJ) : 1991 voyageurs","NANTES-ATLANTIQUE (LFRS) : 158624 voyageurs","ST-NAZAIRE-MONTOIR (LFRZ) : 123 voyageurs","TOURS-VAL DE LOIRE (LFOT) : 4033 voyageurs","BALE-MULHOUSE (LFSB) : 143359 voyageurs","RENNES-ST-JACQUES (LFRN) : 18428 voyageurs","BREST-BRETAGNE (LFRB) : 42894 voyageurs","STRASBOURG-ENTZHEIM (LFST) : 29547 voyageurs","PARIS-ORLY (LFPO) : 764711 voyageurs","CHALONS-VATRY (LFOK) : 2347 voyageurs","PARIS-LE BOURGET (LFPB) : 6959 voyageurs","PARIS-CHARLES DE GAULLE (LFPG) : 1121244 voyageurs","CAEN-CARPIQUET (LFRK) : 20166 voyageurs","BEAUVAIS-TILLE (LFOB) : 74030 voyageurs","LILLE-LESQUIN (LFQQ) : 67077 voyageurs"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[-23.37,50.56],"lng":[-152.24,168.04]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Comme prÃ©cÃ©demment, nous proposons de transformer la production de cette carte en fonction, cela nous permettra dâ€™avoir une application lÃ©gÃ¨re. LÃ  encore câ€™est un exercice optionnel mais intÃ©ressant Ã  faire pour dÃ©couvrir la logique de la programmation fonctionnelle.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<i class="bi bi-book"></i> Exercice 5b (optionnel): une fonction pour notre carte
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li>CrÃ©er une fonction <code>map_leaflet_airport</code> avec les arguments <code>df</code>, <code>airports_location</code> et <code>selected_date</code> produisant la carte. InsÃ©rer celle-ci dans le script <code>R/figures.R</code></li>
<li>Mettre Ã  jour <code>main.R</code> pour utiliser cette fonction dans votre chaine. Nâ€™oubliez pas de dÃ©finir <code>selected_date</code> dans votre script.</li>
</ul>
</div>
</div>
</div>
<details>
<summary>
Code de <code>R/figures.R</code> Ã  reprendre
</summary>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R/figures.R (fin du fichier)</strong></pre>
</div>
<div class="sourceCode" id="cb55" data-startfrom="20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r" style="counter-reset: source-line 19;"><span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>map_leaflet_airport <span class="ot">&lt;-</span> <span class="cf">function</span>(df, airports_location, months, years){</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>  palette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span>)</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>  trafic_date <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(anmois, <span class="st">"01"</span>, <span class="at">sep=</span><span class="st">""</span>), <span class="at">format =</span> <span class="st">"%Y%m%d"</span>)</span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(mois <span class="sc">%in%</span> months, an <span class="sc">%in%</span> years)</span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a>  trafic_aeroports <span class="ot">&lt;-</span> airports_location <span class="sc">%&gt;%</span></span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">inner_join</span>(trafic_date, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Code.OACI"</span> <span class="ot">=</span> <span class="st">"apt"</span>))</span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a>  trafic_aeroports <span class="ot">&lt;-</span> trafic_aeroports <span class="sc">%&gt;%</span></span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">volume =</span> <span class="fu">ntile</span>(trafic, <span class="dv">3</span>)</span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> palette[volume]</span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a>    )  </span>
<span id="cb55-41"><a href="#cb55-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-42"><a href="#cb55-42" aria-hidden="true" tabindex="-1"></a>  icons <span class="ot">&lt;-</span> <span class="fu">awesomeIcons</span>(</span>
<span id="cb55-43"><a href="#cb55-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">'plane'</span>,</span>
<span id="cb55-44"><a href="#cb55-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">iconColor =</span> <span class="st">'black'</span>,</span>
<span id="cb55-45"><a href="#cb55-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">library =</span> <span class="st">'fa'</span>,</span>
<span id="cb55-46"><a href="#cb55-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">markerColor =</span> trafic_aeroports<span class="sc">$</span>color</span>
<span id="cb55-47"><a href="#cb55-47" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-48"><a href="#cb55-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-49"><a href="#cb55-49" aria-hidden="true" tabindex="-1"></a>  carte_interactive <span class="ot">&lt;-</span> <span class="fu">leaflet</span>(trafic_aeroports) <span class="sc">%&gt;%</span> <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-50"><a href="#cb55-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">addAwesomeMarkers</span>(</span>
<span id="cb55-51"><a href="#cb55-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">icon=</span>icons[],</span>
<span id="cb55-52"><a href="#cb55-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">label=</span><span class="sc">~</span><span class="fu">paste0</span>(Nom, <span class="st">""</span>, <span class="st">" ("</span>,Code.OACI, <span class="st">") : "</span>, trafic, <span class="st">" voyageurs"</span>)</span>
<span id="cb55-53"><a href="#cb55-53" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb55-54"><a href="#cb55-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-55"><a href="#cb55-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(carte_interactive)</span>
<span id="cb55-56"><a href="#cb55-56" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<details>
<summary>
Code de <code>intermediates/exo5.R</code> Ã  reprendre
</summary>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>main.R</strong></pre>
</div>
<div class="sourceCode" id="cb56" data-startfrom="20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r" style="counter-reset: source-line 19;"><span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>month <span class="ot">&lt;-</span> MONTHS_LIST[<span class="dv">1</span>]</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data ----------------------------------</span></span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>urls <span class="ot">&lt;-</span> <span class="fu">create_data_list</span>(<span class="st">"./sources.yml"</span>)</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>pax_apt_all <span class="ot">&lt;-</span> <span class="fu">import_airport_data</span>(<span class="fu">unlist</span>(urls<span class="sc">$</span>airports))</span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>pax_cie_all <span class="ot">&lt;-</span> <span class="fu">import_compagnies_data</span>(<span class="fu">unlist</span>(urls<span class="sc">$</span>compagnies))</span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>pax_lsn_all <span class="ot">&lt;-</span> <span class="fu">import_liaisons_data</span>(<span class="fu">unlist</span>(urls<span class="sc">$</span>liaisons))</span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>airports_location <span class="ot">&lt;-</span> <span class="fu">st_read</span>(urls<span class="sc">$</span>geojson<span class="sc">$</span>airport)</span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>liste_aeroports <span class="ot">&lt;-</span> <span class="fu">unique</span>(pax_apt_all<span class="sc">$</span>apt)</span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a>default_airport <span class="ot">&lt;-</span> liste_aeroports[<span class="dv">1</span>]</span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-37"><a href="#cb56-37" aria-hidden="true" tabindex="-1"></a><span class="co"># OBJETS NECESSAIRES A L'APPLICATION ------------------------</span></span>
<span id="cb56-38"><a href="#cb56-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-39"><a href="#cb56-39" aria-hidden="true" tabindex="-1"></a>trafic_aeroports <span class="ot">&lt;-</span> pax_apt_all <span class="sc">%&gt;%</span></span>
<span id="cb56-40"><a href="#cb56-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trafic =</span> apt_pax_dep <span class="sc">+</span> apt_pax_tr <span class="sc">+</span> apt_pax_arr) <span class="sc">%&gt;%</span></span>
<span id="cb56-41"><a href="#cb56-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(apt <span class="sc">%in%</span> default_airport) <span class="sc">%&gt;%</span></span>
<span id="cb56-42"><a href="#cb56-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb56-43"><a href="#cb56-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(anmois, <span class="st">"01"</span>, <span class="at">sep=</span><span class="st">""</span>), <span class="at">format =</span> <span class="st">"%Y%m%d"</span>)</span>
<span id="cb56-44"><a href="#cb56-44" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb56-45"><a href="#cb56-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-46"><a href="#cb56-46" aria-hidden="true" tabindex="-1"></a>stats_aeroports <span class="ot">&lt;-</span> <span class="fu">summary_stat_airport</span>(</span>
<span id="cb56-47"><a href="#cb56-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">create_data_from_input</span>(pax_apt_all, year, month)</span>
<span id="cb56-48"><a href="#cb56-48" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-49"><a href="#cb56-49" aria-hidden="true" tabindex="-1"></a>stats_liaisons  <span class="ot">&lt;-</span> <span class="fu">summary_stat_liaisons</span>(</span>
<span id="cb56-50"><a href="#cb56-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">create_data_from_input</span>(pax_lsn_all, year, month)</span>
<span id="cb56-51"><a href="#cb56-51" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-52"><a href="#cb56-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-53"><a href="#cb56-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-54"><a href="#cb56-54" aria-hidden="true" tabindex="-1"></a><span class="co"># VALORISATIONS ----------------------------------------------</span></span>
<span id="cb56-55"><a href="#cb56-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-56"><a href="#cb56-56" aria-hidden="true" tabindex="-1"></a>figure_plotly <span class="ot">&lt;-</span> <span class="fu">plot_airport_line</span>(trafic_aeroports,default_airport)</span>
<span id="cb56-57"><a href="#cb56-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-58"><a href="#cb56-58" aria-hidden="true" tabindex="-1"></a>table_airports <span class="ot">&lt;-</span> <span class="fu">create_table_airports</span>(stats_aeroports)</span>
<span id="cb56-59"><a href="#cb56-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-60"><a href="#cb56-60" aria-hidden="true" tabindex="-1"></a>carte_interactive <span class="ot">&lt;-</span> <span class="fu">map_leaflet_airport</span>(</span>
<span id="cb56-61"><a href="#cb56-61" aria-hidden="true" tabindex="-1"></a>  pax_apt_all, airports_location,</span>
<span id="cb56-62"><a href="#cb56-62" aria-hidden="true" tabindex="-1"></a>  month, year</span>
<span id="cb56-63"><a href="#cb56-63" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
</section>
</section>
<section id="crÃ©ation-de-lapplication" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> CrÃ©ation de lâ€™application</h1>
<p>Maintenant tous les ingrÃ©dients sont lÃ  pour transformer cette chaÃ®ne en application interactive. Lâ€™architecture de notre application sera la suivante:</p>
<p><img src="img/ui-r.png" class="img-fluid"></p>
<p>Comme toute application <em>web</em>, <code>Shiny</code> repose sur deux piliers:</p>
<ul>
<li>lâ€™interface utilisateur (UI) qui prÃ©sente au navigateur des actions possibles et affiche des <em>output</em> adaptÃ©s</li>
<li>le serveur qui rÃ©pond Ã  ces actions de lâ€™utilisateur, produit les <em>output</em> et les envoie Ã  lâ€™interface</li>
</ul>
<p>Supprimer les fichiers <code>ui.R</code> et <code>server.R</code> dans votre dossier de travail. Nous allons les recrÃ©er progressivement afin de comprendre, pas Ã  pas, la logique dâ€™une application.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<i class="bi bi-book"></i> Exercice 6: crÃ©ation de la structure de lâ€™application
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ol type="1">
<li>CrÃ©er le fichier <code>global.R</code> Ã  partir de <code>main.R</code> en ne conservant que les lignes jusquâ€™Ã  la crÃ©ation (incluse) de lâ€™objet <code>trafic_aeroports</code></li>
</ol>
<details>
<summary>
Le fichier <code>global.R</code> attendu
</summary>
<div class="sourceCode" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Environment ----------------------------------</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bslib)</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/import_data.R"</span>)</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/create_data_list.R"</span>)</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/clean_dataframe.R"</span>)</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/divers_functions.R"</span>)</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/tables.R"</span>)</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/figures.R"</span>)</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Global variables ---------------------------</span></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>YEARS_LIST <span class="ot">&lt;-</span> <span class="dv">2018</span><span class="sc">:</span><span class="dv">2022</span></span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>MONTHS_LIST <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span></span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data ----------------------------------</span></span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>urls <span class="ot">&lt;-</span> <span class="fu">create_data_list</span>(<span class="st">"./sources.yml"</span>)</span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a>pax_apt_all <span class="ot">&lt;-</span> <span class="fu">import_airport_data</span>(<span class="fu">unlist</span>(urls<span class="sc">$</span>airports))</span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a>pax_cie_all <span class="ot">&lt;-</span> <span class="fu">import_compagnies_data</span>(<span class="fu">unlist</span>(urls<span class="sc">$</span>compagnies))</span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a>pax_lsn_all <span class="ot">&lt;-</span> <span class="fu">import_liaisons_data</span>(<span class="fu">unlist</span>(urls<span class="sc">$</span>liaisons))</span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a>airports_location <span class="ot">&lt;-</span> <span class="fu">st_read</span>(urls<span class="sc">$</span>geojson<span class="sc">$</span>airport)</span>
<span id="cb57-35"><a href="#cb57-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-36"><a href="#cb57-36" aria-hidden="true" tabindex="-1"></a>liste_aeroports <span class="ot">&lt;-</span> <span class="fu">unique</span>(pax_apt_all<span class="sc">$</span>apt)</span>
<span id="cb57-37"><a href="#cb57-37" aria-hidden="true" tabindex="-1"></a>default_airport <span class="ot">&lt;-</span> liste_aeroports[<span class="dv">1</span>]</span>
<span id="cb57-38"><a href="#cb57-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-39"><a href="#cb57-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-40"><a href="#cb57-40" aria-hidden="true" tabindex="-1"></a><span class="co"># OBJETS NECESSAIRES A L'APPLICATION ------------------------</span></span>
<span id="cb57-41"><a href="#cb57-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-42"><a href="#cb57-42" aria-hidden="true" tabindex="-1"></a>trafic_aeroports <span class="ot">&lt;-</span> pax_apt_all <span class="sc">%&gt;%</span></span>
<span id="cb57-43"><a href="#cb57-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trafic =</span> apt_pax_dep <span class="sc">+</span> apt_pax_tr <span class="sc">+</span> apt_pax_arr) <span class="sc">%&gt;%</span></span>
<span id="cb57-44"><a href="#cb57-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(apt <span class="sc">%in%</span> default_airport) <span class="sc">%&gt;%</span></span>
<span id="cb57-45"><a href="#cb57-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb57-46"><a href="#cb57-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(anmois, <span class="st">"01"</span>, <span class="at">sep=</span><span class="st">""</span>), <span class="at">format =</span> <span class="st">"%Y%m%d"</span>)</span>
<span id="cb57-47"><a href="#cb57-47" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<p>Lâ€™objectif de la suite de lâ€™exercice est de comprendre comment fonctionne une application. Celle-ci sera enrichie ensuite de nos productions graphiques.</p>
<p>CrÃ©er les fichiers <code>ui.R</code> et <code>server.R</code> Ã  partir des modÃ¨les ci-dessous</p>
<details>
<summary>
Code de <code>ui.R</code> Ã  reprendre
</summary>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>ui.R</strong></pre>
</div>
<div class="sourceCode" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>main_color <span class="ot">&lt;-</span> <span class="st">"black"</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>input_date <span class="ot">&lt;-</span> shinyWidgets<span class="sc">::</span><span class="fu">airDatepickerInput</span>(</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"date"</span>,</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">"Mois choisi"</span>,</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="st">"2019-01-01"</span>,</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">view =</span> <span class="st">"months"</span>,</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">minView =</span> <span class="st">"months"</span>,</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">minDate =</span> <span class="st">"2018-01-01"</span>,</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">maxDate =</span> <span class="st">"2022-12-01"</span>,</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">dateFormat =</span> <span class="st">"MMMM yyyy"</span>,</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">language =</span> <span class="st">"fr"</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>input_airport <span class="ot">&lt;-</span> <span class="fu">selectInput</span>(</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"select"</span>,</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"AÃ©roport choisi"</span>,</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">choices =</span> liste_aeroports,</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">selected =</span> default_airport</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">page_navbar</span>(</span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Tableau de bord des aÃ©roports franÃ§ais"</span>,</span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">bg =</span> main_color,</span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">inverse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">header =</span> <span class="fu">em</span>(<span class="st">"Projet issu du funathon 2024, organisÃ© par l'Insee et la DGAC"</span>),</span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout_columns</span>(</span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">card</span>(</span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>      input_date,</span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">textOutput</span>(<span class="st">"date1"</span>)</span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a>      <span class="co"># table viendra ici</span></span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">layout_columns</span>(</span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card</span>(</span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># carte viendra ici</span></span>
<span id="cb58-36"><a href="#cb58-36" aria-hidden="true" tabindex="-1"></a>        <span class="fu">textOutput</span>(<span class="st">"date2"</span>)</span>
<span id="cb58-37"><a href="#cb58-37" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb58-38"><a href="#cb58-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card</span>(<span class="fu">card_header</span>(<span class="st">"FrÃ©quentation d'un aÃ©roport"</span>, <span class="at">class =</span> <span class="st">"bg-dark"</span>),</span>
<span id="cb58-39"><a href="#cb58-39" aria-hidden="true" tabindex="-1"></a>           input_airport,</span>
<span id="cb58-40"><a href="#cb58-40" aria-hidden="true" tabindex="-1"></a>           <span class="fu">textOutput</span>(<span class="st">"airport"</span>)</span>
<span id="cb58-41"><a href="#cb58-41" aria-hidden="true" tabindex="-1"></a>           <span class="co"># figure viendra ici</span></span>
<span id="cb58-42"><a href="#cb58-42" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb58-43"><a href="#cb58-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">col_widths =</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">12</span>)</span>
<span id="cb58-44"><a href="#cb58-44" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb58-45"><a href="#cb58-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols_widths =</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">12</span>,<span class="dv">12</span>)</span>
<span id="cb58-46"><a href="#cb58-46" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb58-47"><a href="#cb58-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb58-48"><a href="#cb58-48" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<details>
<summary>
Code de <code>server.R</code> Ã  reprendre
</summary>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>server.R</strong></pre>
</div>
<div class="sourceCode" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span>(input, output) {</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>date1 <span class="ot">&lt;-</span> <span class="fu">renderText</span>(input<span class="sc">$</span>date)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>date2 <span class="ot">&lt;-</span> <span class="fu">renderText</span>(input<span class="sc">$</span>date)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>airport <span class="ot">&lt;-</span> <span class="fu">renderText</span>(input<span class="sc">$</span>select)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<p>Lancer lâ€™application en lanÃ§ant <code>shiny::runApp()</code> depuis la console <code>R</code>. Si <code>firefox</code> affiche un message de blocage de lâ€™ouverture dâ€™une fenÃªtre, autoriser celle-ci.</p>
<ol type="1">
<li>Observer votre console, notamment les messages lors du lancement de lâ€™application</li>
<li>Jouer avec les <em>inputs</em> et observer la maniÃ¨re dont lâ€™affichage sâ€™ajuste</li>
</ol>
<p>Maintenant, se pencher sur le code source et observer lâ€™aller-retour entre les objets du script <code>ui.R</code> et <code>server.R</code>.</p>
<p>Tuer lâ€™application avec le bouton stop de la console.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<i class="bi bi-book"></i> Exercice 7: finaliser lâ€™application
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Le sujet le plus difficile, quand on dÃ©couvre <code>Shiny</code> est la gestion de la rÃ©activitÃ©, câ€™est-Ã -dire de lâ€™aller-retour entre interface utilisateur et serveur. Pour comprendre cela, la maniÃ¨re la plus directe est sans doute de se plonger dans le code de lâ€™application complÃ¨te:</p>
<details>
<summary>
Code de <code>ui.R</code> Ã  reprendre
</summary>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>ui.R</strong></pre>
</div>
<div class="sourceCode" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>main_color <span class="ot">&lt;-</span> <span class="st">"black"</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>input_date <span class="ot">&lt;-</span> shinyWidgets<span class="sc">::</span><span class="fu">airDatepickerInput</span>(</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"date"</span>,</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">"Mois choisi"</span>,</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="st">"2019-01-01"</span>,</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">view =</span> <span class="st">"months"</span>,</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">minView =</span> <span class="st">"months"</span>,</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">minDate =</span> <span class="st">"2018-01-01"</span>,</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">maxDate =</span> <span class="st">"2022-12-01"</span>,</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">dateFormat =</span> <span class="st">"MMMM yyyy"</span>,</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">language =</span> <span class="st">"fr"</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>input_airport <span class="ot">&lt;-</span> <span class="fu">selectInput</span>(</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"select"</span>,</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"AÃ©roport choisi"</span>,</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">choices =</span> liste_aeroports,</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">selected =</span> default_airport</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">page_navbar</span>(</span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Tableau de bord des aÃ©roports franÃ§ais"</span>,</span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">bg =</span> main_color,</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">inverse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">header =</span> <span class="fu">em</span>(<span class="st">"Projet issu du funathon 2024, organisÃ© par l'Insee et la DGAC"</span>),</span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout_columns</span>(</span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">card</span>(</span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a>      input_date,</span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">gt_output</span>(<span class="at">outputId =</span> <span class="st">"table"</span>)</span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">layout_columns</span>(</span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card</span>(<span class="fu">leafletOutput</span>(<span class="st">"carte"</span>)),</span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card</span>(<span class="fu">card_header</span>(<span class="st">"FrÃ©quentation d'un aÃ©roport"</span>, <span class="at">class =</span> <span class="st">"bg-dark"</span>),</span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a>           input_airport,</span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a>           <span class="fu">plotlyOutput</span>(<span class="st">"lineplot"</span>)</span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a>          ),</span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">col_widths =</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">12</span>)</span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols_widths =</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">12</span>,<span class="dv">12</span>)</span>
<span id="cb60-41"><a href="#cb60-41" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb60-42"><a href="#cb60-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-43"><a href="#cb60-43" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-44"><a href="#cb60-44" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<details>
<summary>
Code de <code>server.R</code> Ã  reprendre
</summary>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>server.R</strong></pre>
</div>
<div class="sourceCode" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span>(input, output) {</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  table_liaisons <span class="ot">=</span> <span class="fu">reactive</span>({</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summary_stat_airport</span>(</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">create_data_from_input</span>(</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>          pax_apt_all,</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">year</span>(input<span class="sc">$</span>date),</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">month</span>(input<span class="sc">$</span>date)</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>table <span class="ot">&lt;-</span> <span class="fu">render_gt</span>(</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">create_table_airports</span>(<span class="fu">table_liaisons</span>())</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>carte <span class="ot">&lt;-</span> <span class="fu">renderLeaflet</span>(</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map_leaflet_airport</span>(</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>      pax_apt_all, airports_location,</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">month</span>(input<span class="sc">$</span>date), <span class="fu">year</span>(input<span class="sc">$</span>date)</span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>lineplot <span class="ot">&lt;-</span> <span class="fu">renderPlotly</span>(</span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot_airport_line</span>(pax_apt_all, input<span class="sc">$</span>select)</span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<ol type="1">
<li>Observer la maniÃ¨re dont le fichier <code>ui.R</code> a Ã©voluÃ©.</li>
<li>Observer les nouveaux Ã©lÃ©ments dans <code>server.R</code> et la maniÃ¨re dont ceux-ci sont projetÃ©s ensuite dans lâ€™interface utilisateur</li>
</ol>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<i class="bi bi-book"></i> Exercice 8 (optionnel): amusez-vous Ã  enrichir lâ€™application
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Cette application Ã©tait un squelette minimal dâ€™application. Nâ€™hÃ©sitez pas Ã  crÃ©er votre propre version. Voici quelques idÃ©es:</p>
<ul>
<li>Changer lâ€™apparence graphique ;</li>
<li>CrÃ©er une application avec plusieurs pages ;</li>
<li>Enrichir les productions graphiques sur lâ€™applicationâ€¦</li>
</ul>
</div>
</div>
</div>
</section>
<section id="partager-cette-application-une-ouverture-vers-la-mise-en-production" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Partager cette application: une ouverture vers la mise en production</h1>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Ces fichiers ne sont pas gÃ©nÃ©rÃ©s manuellement. Ce sont des outils adaptÃ©s (<code>renv</code> pour <code>R</code>, <code>pip</code> pour <code>Python</code>) qui font ce travail de versionnage de lâ€™environnement.<a href="#fnref1" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn2"><p>Si vous Ãªtes peu familier avec ce type de fichiers, vous pouvez consulter la <a href="https://book.utilitr.org/03_Fiches_thematiques/Fiche_import_fichiers_plats.html">fiche <code>utilitR</code></a> sur le sujet<a href="#fnref2" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn3"><p>Si vous Ãªtes peu familier avec les donnÃ©es gÃ©ographiques, vous pouvez retenir lâ€™idÃ©e quâ€™il sâ€™agit de donnÃ©es traditionnelles auxquelles sâ€™ajoute une dimension spatiale. Cette derniÃ¨re vise Ã  localiser les donnÃ©es sur la terre. La localisation se fait dans un espace Ã  deux dimensions (espace cartÃ©sien) alors que notre planÃ¨te est une sphÃ¨re en trois dimensions. Le principe dâ€™un systÃ¨me de projection est de faire ce passage en deux dimensions des positions. Le plus connu est le systÃ¨me GPS, qui est un hÃ©ritier lointain de la reprÃ©sentation du monde par <a href="https://fr.wikipedia.org/wiki/G%C3%A9rard_Mercator">Mercator</a>. Ce systÃ¨me est connu sous le nom de WGS 84 et porte le code EPSG 4326. Lâ€™autre systÃ¨me Ã  retenir est le Lambert 93 (code EPSG 2154) qui est la projection lÃ©gale en France (celle-ci, <em>a contrario</em> du Mercator, ne dÃ©forme pas la France sur une carte). Pour en savoir plus sur les systÃ¨mes de reprÃ©sentation, les avantages et inconvÃ©nients de chacun, il existe de nombreuses ressources en ligne. Des Ã©lÃ©ments introductifs, et des dÃ©monstrations interactives, en lien avec la librairie <code>Geopandas</code> de <code>Python</code> sont disponibles <a href="https://pythonds.linogaliana.fr/content/manipulation/03_geopandas_intro.html#principe">ici</a>.<a href="#fnref3" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn4"><p>Vous perdrez la mise en forme du <em>header</em> du tableau qui nâ€™est pas conciliable avec lâ€™interactivitÃ©.<a href="#fnref4" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>